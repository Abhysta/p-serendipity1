(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return mg});var r=n("ofXK"),i=n("fXoL"),o=n("XNiG"),s=n("2Vo4"),a=n("HDdC"),u=n("VRyK"),c=n("7Hc7"),h=n("LRne"),l=(n("xgIS"),n("pLZG")),f=n("lJxs"),d=n("Kj3r"),p=n("eIep"),g=n("1G5W");n("IzEk"),n("vkgz");class y{constructor(t=!1,e="all",n="",r="",i=0){this.matches=t,this.mediaQuery=e,this.mqAlias=n,this.suffix=r,this.priority=i,this.property=""}clone(){return new y(this.matches,this.mediaQuery,this.mqAlias,this.suffix)}}const m={addFlexToParent:!0,addOrientationBps:!1,disableDefaultBps:!1,disableVendorPrefixes:!1,serverLoaded:!1,useColumnBasisZero:!0,printWithBreakpoints:[],mediaTriggerAutoRestore:!0,ssrObserveBreakpoints:[]},v=new i.s("Flex Layout token, config options for the library",{providedIn:"root",factory:()=>m}),b=(new i.s("FlexLayoutServerLoaded",{providedIn:"root",factory:()=>!1}),new i.s("Flex Layout token, collect all breakpoints into one provider",{providedIn:"root",factory:()=>null}));function w(t,e){return t=t?t.clone():new y,e&&(t.mqAlias=e.alias,t.mediaQuery=e.mediaQuery,t.suffix=e.suffix,t.priority=e.priority),t}const E=[{alias:"xs",mediaQuery:"screen and (min-width: 0px) and (max-width: 599.98px)",priority:1e3},{alias:"sm",mediaQuery:"screen and (min-width: 600px) and (max-width: 959.98px)",priority:900},{alias:"md",mediaQuery:"screen and (min-width: 960px) and (max-width: 1279.98px)",priority:800},{alias:"lg",mediaQuery:"screen and (min-width: 1280px) and (max-width: 1919.98px)",priority:700},{alias:"xl",mediaQuery:"screen and (min-width: 1920px) and (max-width: 4999.98px)",priority:600},{alias:"lt-sm",overlapping:!0,mediaQuery:"screen and (max-width: 599.98px)",priority:950},{alias:"lt-md",overlapping:!0,mediaQuery:"screen and (max-width: 959.98px)",priority:850},{alias:"lt-lg",overlapping:!0,mediaQuery:"screen and (max-width: 1279.98px)",priority:750},{alias:"lt-xl",overlapping:!0,priority:650,mediaQuery:"screen and (max-width: 1919.98px)"},{alias:"gt-xs",overlapping:!0,mediaQuery:"screen and (min-width: 600px)",priority:-950},{alias:"gt-sm",overlapping:!0,mediaQuery:"screen and (min-width: 960px)",priority:-850},{alias:"gt-md",overlapping:!0,mediaQuery:"screen and (min-width: 1280px)",priority:-750},{alias:"gt-lg",overlapping:!0,mediaQuery:"screen and (min-width: 1920px)",priority:-650}],I="(orientation: portrait) and (max-width: 599.98px)",T="(orientation: landscape) and (max-width: 959.98px)",O="(orientation: portrait) and (min-width: 600px) and (max-width: 839.98px)",_="(orientation: landscape) and (min-width: 960px) and (max-width: 1279.98px)",S="(orientation: portrait) and (min-width: 840px)",A="(orientation: landscape) and (min-width: 1280px)",k={HANDSET:`${I}, ${T}`,TABLET:`${O} , ${_}`,WEB:`${S}, ${A} `,HANDSET_PORTRAIT:`${I}`,TABLET_PORTRAIT:`${O} `,WEB_PORTRAIT:`${S}`,HANDSET_LANDSCAPE:`${T}`,TABLET_LANDSCAPE:`${_}`,WEB_LANDSCAPE:`${A}`},D=[{alias:"handset",priority:2e3,mediaQuery:k.HANDSET},{alias:"handset.landscape",priority:2e3,mediaQuery:k.HANDSET_LANDSCAPE},{alias:"handset.portrait",priority:2e3,mediaQuery:k.HANDSET_PORTRAIT},{alias:"tablet",priority:2100,mediaQuery:k.TABLET},{alias:"tablet.landscape",priority:2100,mediaQuery:k.TABLET_LANDSCAPE},{alias:"tablet.portrait",priority:2100,mediaQuery:k.TABLET_PORTRAIT},{alias:"web",priority:2200,mediaQuery:k.WEB,overlapping:!0},{alias:"web.landscape",priority:2200,mediaQuery:k.WEB_LANDSCAPE,overlapping:!0},{alias:"web.portrait",priority:2200,mediaQuery:k.WEB_PORTRAIT,overlapping:!0}],x=/(\.|-|_)/g;function N(t){let e=t.length>0?t.charAt(0):"",n=t.length>1?t.slice(1):"";return e.toUpperCase()+n}const j=new i.s("Token (@angular/flex-layout) Breakpoints",{providedIn:"root",factory:()=>{const t=Object(i.X)(b),e=Object(i.X)(v),n=[].concat.apply([],(t||[]).map(t=>Array.isArray(t)?t:[t]));return function(t,e=[]){const n={};return t.forEach(t=>{n[t.alias]=t}),e.forEach(t=>{n[t.alias]?function(t,...e){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(let n of e)if(null!=n)for(let e in n)n.hasOwnProperty(e)&&(t[e]=n[e])}(n[t.alias],t):n[t.alias]=t}),function(t){return t.forEach(t=>{t.suffix||(t.suffix=t.alias.replace(x,"|").split("|").map(N).join(""),t.overlapping=!!t.overlapping)}),t}(Object.keys(n).map(t=>n[t]))}((e.disableDefaultBps?[]:E).concat(e.addOrientationBps?D:[]),n)}});function C(t,e){return(e&&e.priority||0)-(t&&t.priority||0)}function P(t,e){return(t.priority||0)-(e.priority||0)}let R=(()=>{class t{constructor(t){this.findByMap=new Map,this.items=[...t].sort(P)}findByAlias(t){return t?this.findWithPredicate(t,e=>e.alias==t):null}findByQuery(t){return this.findWithPredicate(t,e=>e.mediaQuery==t)}get overlappings(){return this.items.filter(t=>1==t.overlapping)}get aliases(){return this.items.map(t=>t.alias)}get suffixes(){return this.items.map(t=>t.suffix?t.suffix:"")}findWithPredicate(t,e){let n=this.findByMap.get(t);return n||(n=this.items.find(e)||null,this.findByMap.set(t,n)),n||null}}return t.\u0275fac=function(e){return new(e||t)(i.Zb(j))},t.\u0275prov=Object(i.Lb)({factory:function(){return new t(Object(i.Zb)(j))},token:t,providedIn:"root"}),t})(),L=(()=>{class t{constructor(t,e,n){this._zone=t,this._platformId=e,this._document=n,this.source=new s.a(new y(!0)),this.registry=new Map,this.pendingRemoveListenerFns=[],this._observable$=this.source.asObservable()}get activations(){const t=[];return this.registry.forEach((e,n)=>{e.matches&&t.push(n)}),t}isActive(t){const e=this.registry.get(t);return e?e.matches:this.registerQuery(t).some(t=>t.matches)}observe(t,e=!1){if(t&&t.length){const n=this._observable$.pipe(Object(l.a)(n=>!e||t.indexOf(n.mediaQuery)>-1)),r=new a.a(e=>{const n=this.registerQuery(t);if(n.length){const t=n.pop();n.forEach(t=>{e.next(t)}),this.source.next(t)}e.complete()});return Object(u.a)(r,n)}return this._observable$}registerQuery(t){const e=Array.isArray(t)?t:[t],n=[];return function(t,e){const n=t.filter(t=>!V[t]);if(n.length>0){const t=n.join(", ");try{const r=e.createElement("style");r.setAttribute("type","text/css"),r.styleSheet||r.appendChild(e.createTextNode(`\n/*\n  @angular/flex-layout - workaround for possible browser quirk with mediaQuery listeners\n  see http://bit.ly/2sd4HMP\n*/\n@media ${t} {.fx-query-test{ }}\n`)),e.head.appendChild(r),n.forEach(t=>V[t]=r)}catch(Lp){console.error(Lp)}}}(e,this._document),e.forEach(t=>{const e=e=>{this._zone.run(()=>this.source.next(new y(e.matches,t)))};let r=this.registry.get(t);r||(r=this.buildMQL(t),r.addListener(e),this.pendingRemoveListenerFns.push(()=>r.removeListener(e)),this.registry.set(t,r)),r.matches&&n.push(new y(!0,t))}),n}ngOnDestroy(){let t;for(;t=this.pendingRemoveListenerFns.pop();)t()}buildMQL(t){return function(t,e){return e&&window.matchMedia("all").addListener?window.matchMedia(t):{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{},onchange:null,addEventListener(){},removeEventListener(){},dispatchEvent:()=>!1}}(t,Object(r.u)(this._platformId))}}return t.\u0275fac=function(e){return new(e||t)(i.Zb(i.B),i.Zb(i.D),i.Zb(r.d))},t.\u0275prov=Object(i.Lb)({factory:function(){return new t(Object(i.Zb)(i.B),Object(i.Zb)(i.D),Object(i.Zb)(r.d))},token:t,providedIn:"root"}),t})();const V={},M="print",U={alias:M,mediaQuery:M,priority:1e3};let F=(()=>{class t{constructor(t,e,n){this.breakpoints=t,this.layoutConfig=e,this._document=n,this.registeredBeforeAfterPrintHooks=!1,this.isPrintingBeforeAfterEvent=!1,this.beforePrintEventListeners=[],this.afterPrintEventListeners=[],this.isPrinting=!1,this.queue=new q,this.deactivations=[]}withPrintQuery(t){return[...t,M]}isPrintEvent(t){return t.mediaQuery.startsWith(M)}get printAlias(){return this.layoutConfig.printWithBreakpoints||[]}get printBreakPoints(){return this.printAlias.map(t=>this.breakpoints.findByAlias(t)).filter(t=>null!==t)}getEventBreakpoints({mediaQuery:t}){const e=this.breakpoints.findByQuery(t);return(e?[...this.printBreakPoints,e]:this.printBreakPoints).sort(C)}updateEvent(t){let e=this.breakpoints.findByQuery(t.mediaQuery);return this.isPrintEvent(t)&&(e=this.getEventBreakpoints(t)[0],t.mediaQuery=e?e.mediaQuery:""),w(t,e)}registerBeforeAfterPrintHooks(t){if(!this._document.defaultView||this.registeredBeforeAfterPrintHooks)return;this.registeredBeforeAfterPrintHooks=!0;const e=()=>{this.isPrinting||(this.isPrintingBeforeAfterEvent=!0,this.startPrinting(t,this.getEventBreakpoints(new y(!0,M))),t.updateStyles())},n=()=>{this.isPrintingBeforeAfterEvent=!1,this.isPrinting&&(this.stopPrinting(t),t.updateStyles())};this._document.defaultView.addEventListener("beforeprint",e),this._document.defaultView.addEventListener("afterprint",n),this.beforePrintEventListeners.push(e),this.afterPrintEventListeners.push(n)}interceptEvents(t){return this.registerBeforeAfterPrintHooks(t),e=>{this.isPrintEvent(e)?e.matches&&!this.isPrinting?(this.startPrinting(t,this.getEventBreakpoints(e)),t.updateStyles()):e.matches||!this.isPrinting||this.isPrintingBeforeAfterEvent||(this.stopPrinting(t),t.updateStyles()):this.collectActivations(e)}}blockPropagation(){return t=>!(this.isPrinting||this.isPrintEvent(t))}startPrinting(t,e){this.isPrinting=!0,t.activatedBreakpoints=this.queue.addPrintBreakpoints(e)}stopPrinting(t){t.activatedBreakpoints=this.deactivations,this.deactivations=[],this.queue.clear(),this.isPrinting=!1}collectActivations(t){if(!this.isPrinting||this.isPrintingBeforeAfterEvent)if(t.matches)this.isPrintingBeforeAfterEvent||(this.deactivations=[]);else{const e=this.breakpoints.findByQuery(t.mediaQuery);e&&(this.deactivations.push(e),this.deactivations.sort(C))}}ngOnDestroy(){this._document.defaultView&&(this.beforePrintEventListeners.forEach(t=>this._document.defaultView.removeEventListener("beforeprint",t)),this.afterPrintEventListeners.forEach(t=>this._document.defaultView.removeEventListener("afterprint",t)))}}return t.\u0275fac=function(e){return new(e||t)(i.Zb(R),i.Zb(v),i.Zb(r.d))},t.\u0275prov=Object(i.Lb)({factory:function(){return new t(Object(i.Zb)(R),Object(i.Zb)(v),Object(i.Zb)(r.d))},token:t,providedIn:"root"}),t})();class q{constructor(){this.printBreakpoints=[]}addPrintBreakpoints(t){return t.push(U),t.sort(C),t.forEach(t=>this.addBreakpoint(t)),this.printBreakpoints}addBreakpoint(t){t&&void 0===this.printBreakpoints.find(e=>e.mediaQuery===t.mediaQuery)&&(this.printBreakpoints=function(t){return!!t&&t.mediaQuery.startsWith(M)}(t)?[t,...this.printBreakpoints]:[...this.printBreakpoints,t])}clear(){this.printBreakpoints=[]}}let B=(()=>{class t{constructor(t,e,n){this.breakpoints=t,this.matchMedia=e,this.hook=n,this.filterOverlaps=!1,this.destroyed$=new o.a,this._media$=this.watchActivations(),this.media$=this._media$.pipe(Object(l.a)(t=>t.length>0),Object(f.a)(t=>t[0]))}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}asObservable(){return this._media$}isActive(t){return function(t){return Array.isArray(t)?t:[t]}(t).map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim()).some(t=>{const e=function(t,e){const n=e.findByAlias(t)||e.findByQuery(t);return n?n.mediaQuery:null}(t,this.breakpoints);return null!==e&&this.matchMedia.isActive(e)})}watchActivations(){const t=this.breakpoints.items.map(t=>t.mediaQuery);return this.buildObservable(t)}buildObservable(t){return this.matchMedia.observe(this.hook.withPrintQuery(t)).pipe(Object(l.a)(t=>t.matches),Object(d.a)(0,c.b),Object(p.a)(t=>Object(h.a)(this.findAllActivations())),Object(f.a)(t=>this.filterOverlaps?t.filter(t=>{const e=this.breakpoints.findByQuery(t.mediaQuery);return!e||!e.overlapping}):t),Object(l.a)(t=>t.filter(t=>t.mediaQuery.length>0).length>0),Object(g.a)(this.destroyed$))}findAllActivations(){return this.matchMedia.activations.map(t=>new y(!0,t)).map(t=>this.hook.isPrintEvent(t)?this.hook.updateEvent(t):t).map(t=>w(t,this.breakpoints.findByQuery(t.mediaQuery))).sort(C)}}return t.\u0275fac=function(e){return new(e||t)(i.Zb(R),i.Zb(L),i.Zb(F))},t.\u0275prov=Object(i.Lb)({factory:function(){return new t(Object(i.Zb)(R),Object(i.Zb)(L),Object(i.Zb)(F))},token:t,providedIn:"root"}),t})();var Q=n("/t3+"),K=n("NFeN"),G=n("XhcP"),z=n("MutI"),H=n("tyNb"),W=n("FKr1"),$=n("bTqV");function X(t,e){if(1&t){const t=i.Wb();i.Vb(0,"mat-icon",22),i.dc("click",function(){return i.tc(t),i.hc(2),i.rc(15).toggle()}),i.Ac(1,"menu"),i.Ub()}}function Y(t,e){if(1&t&&(i.Vb(0,"button",20),i.zc(1,X,2,0,"mat-icon",21),i.Ub()),2&t){const t=i.hc();i.Eb(1),i.mc("ngIf",t.deviceXs)}}function J(t,e){1&t&&(i.Vb(0,"button",23),i.Ac(1,"Home"),i.Ub())}function Z(t,e){1&t&&(i.Vb(0,"button",24),i.Ac(1,"Serendipity"),i.Ub())}function tt(t,e){1&t&&(i.Vb(0,"button",25),i.Ac(1,"Tata Cara"),i.Ub())}function et(t,e){1&t&&(i.Vb(0,"button",26),i.Ac(1,"Tentang"),i.Ub())}function nt(t,e){1&t&&(i.Vb(0,"button",27),i.Ac(1,"Logout"),i.Ub())}let rt=(()=>{class t{constructor(t){this.mediaObserver=t,this.title="myAngular"}ngOnInit(){this.mediaSub=this.mediaObserver.media$.subscribe(t=>{console.log(t.mqAlias),this.deviceXs="xs"===t.mqAlias})}ngOnDestroy(){this.mediaSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(B))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-admin"]],decls:46,vars:15,consts:[[1,"example-header"],[1,"uk-width-expand"],["mat-button","",4,"ngIf"],["mat-button","","routerLink","home","class","w1",4,"ngIf"],["mat-button","","routerLink","serendipity","class","w1",4,"ngIf"],["mat-button","","routerLink","step","class","w1",4,"ngIf"],["mat-button","","routerLink","about","class","w1",4,"ngIf"],["mat-raised-button","","color","accent","routerLink","/login",4,"ngIf"],[1,"admin-container"],["mode","side",1,"sidenav-left",3,"position","opened","fixedInViewport","fixedTopGap","fixedBottomGap"],["sidenav",""],["routerLink","home"],["matListIcon",""],["matLine",""],["routerLink","serendipity"],["routerLink","step"],["routerLink","about"],["routerLink","/login"],["mode","side",1,"example-sidenav",3,"position","fixedInViewport","fixedTopGap","fixedBottomGap"],[2,"background-color","rgb(255, 255, 255)"],["mat-button",""],[3,"click",4,"ngIf"],[3,"click"],["mat-button","","routerLink","home",1,"w1"],["mat-button","","routerLink","serendipity",1,"w1"],["mat-button","","routerLink","step",1,"w1"],["mat-button","","routerLink","about",1,"w1"],["mat-raised-button","","color","accent","routerLink","/login"]],template:function(t,e){1&t&&(i.Tb(0),i.Vb(1,"mat-toolbar",0),i.Vb(2,"mat-icon"),i.Ac(3,"auto_stories"),i.Ub(),i.Vb(4,"span"),i.Ac(5,"Serendipity"),i.Ub(),i.Qb(6,"div",1),i.zc(7,Y,2,1,"button",2),i.zc(8,J,2,0,"button",3),i.zc(9,Z,2,0,"button",4),i.zc(10,tt,2,0,"button",5),i.zc(11,et,2,0,"button",6),i.zc(12,nt,2,0,"button",7),i.Ub(),i.Vb(13,"mat-sidenav-container",8),i.Vb(14,"mat-sidenav",9,10),i.Vb(16,"mat-nav-list"),i.Vb(17,"mat-list-item",11),i.Vb(18,"mat-icon",12),i.Ac(19,"home"),i.Ub(),i.Vb(20,"h3",13),i.Ac(21,"Home"),i.Ub(),i.Ub(),i.Vb(22,"mat-list-item",14),i.Vb(23,"mat-icon",12),i.Ac(24,"book"),i.Ub(),i.Vb(25,"h3",13),i.Ac(26,"Serendipity"),i.Ub(),i.Ub(),i.Vb(27,"mat-list-item",15),i.Vb(28,"mat-icon",12),i.Ac(29,"rule"),i.Ub(),i.Vb(30,"h3",13),i.Ac(31,"Tata Cara"),i.Ub(),i.Ub(),i.Vb(32,"mat-list-item",16),i.Vb(33,"mat-icon",12),i.Ac(34,"info"),i.Ub(),i.Vb(35,"h3",13),i.Ac(36,"Tentang"),i.Ub(),i.Ub(),i.Vb(37,"mat-list-item",17),i.Vb(38,"mat-icon",12),i.Ac(39,"logout"),i.Ub(),i.Vb(40,"h3",13),i.Ac(41,"Logout"),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Qb(42,"mat-sidenav",18,10),i.Vb(44,"mat-sidenav-content",19),i.Qb(45,"router-outlet"),i.Ub(),i.Ub(),i.Sb()),2&t&&(i.Eb(7),i.mc("ngIf",e.deviceXs),i.Eb(1),i.mc("ngIf",!e.deviceXs),i.Eb(1),i.mc("ngIf",!e.deviceXs),i.Eb(1),i.mc("ngIf",!e.deviceXs),i.Eb(1),i.mc("ngIf",!e.deviceXs),i.Eb(1),i.mc("ngIf",!e.deviceXs),i.Eb(2),i.mc("position","end")("opened",!1)("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0),i.Eb(28),i.mc("position","end")("fixedInViewport",!0)("fixedTopGap",60)("fixedBottomGap",0))},directives:[Q.a,K.a,r.l,G.b,G.a,z.d,z.b,H.b,z.a,W.j,G.c,H.d,$.a],styles:["mat-toolbar[_ngcontent-%COMP%]{background-color:#1562c7}.w1[_ngcontent-%COMP%]{color:#fff}"]}),t})();var it=n("w55g");let ot=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["app-home"]],decls:19,vars:0,consts:[[1,"uk-padding"],[1,"uk-background-primary","uk-light","uk-column-1-2@s","uk-padding","uk-panel","uk-text-middle","uk-text-center","uk-text-left@s"],[1,"f1"],[1,"f2"],["src","assets/A1.png","width","300","height","200",1,"uk-align-center","uk-align-right@s"],[1,"uk-padding","uk-panel","uk-text-middle","uk-text-left@s"],["src","assets/A1.png","width","355","height","250",1,"uk-align-center","uk-align-left@s","uk-visible@s"]],template:function(t,e){1&t&&(i.Vb(0,"div",0),i.Vb(1,"div"),i.Vb(2,"div",1),i.Vb(3,"h1",2),i.Ac(4,"Serendipity"),i.Ub(),i.Vb(5,"p",3),i.Ac(6,"Tuliskan Ceritamu Di Sini"),i.Ub(),i.Vb(7,"p",3),i.Ac(8,"Menjadi Lebih Terbuka"),i.Ub(),i.Qb(9,"img",4),i.Ub(),i.Ub(),i.Vb(10,"div"),i.Vb(11,"div",5),i.Qb(12,"img",6),i.Vb(13,"h3"),i.Ac(14,"Apa itu Serendipity ?"),i.Ub(),i.Vb(15,"p"),i.Ac(16,"Serendipity adalah penemuan keberuntungan yang tidak direncanakan. Serendipity adalah kejadian umum sepanjang sejarah penemuan produk dan penemuan ilmiah. pada web ini Serendipity dimaksudkan sebagai ketidaksengajaan, oleh karena itu web ini digunakan sebagai web dimana untuk menuliskan cerita apa saja baik cerita penemuan, cerita kehidupan, dan lainnya."),i.Ub(),i.Vb(17,"p"),i.Ac(18,"Dengan adanya web ini diharapkan agar orang yang sulit meng apresiasikan dirinya dapat mengeluarkannya melalui tulisan pada web ini baik ingin diketahui siapa dirinya atau ingin menyembunyikan identitasnya dengan menuliskan nama penanya pada web ini."),i.Ub(),i.Ub(),i.Ub(),i.Ub())},styles:[".f1[_ngcontent-%COMP%]{font-weight:700;font-size:45px;margin-bottom:30px}.f2[_ngcontent-%COMP%]{font-size:20px;margin-bottom:20px}"]}),t})();var st=n("0IaG"),at=n("D0XW"),ut=n("Cfvw"),ct=n("JX91"),ht=n("Zy1z"),lt=n("Kqap"),ft=n("/uUt"),dt=n("pxpQ"),pt=n("spgP"),gt=n("Jgta"),yt=n("zIRd"),mt=n("mrSG"),vt=n("qOnz"),bt=n("q/0M"),wt=function(t,e){return(wt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Et(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var It,Tt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ot=Ot||{},_t=Tt||self;function St(){}function At(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function kt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Dt="closure_uid_"+(1e9*Math.random()>>>0),xt=0;function Nt(t,e,n){return t.call.apply(t.bind,arguments)}function jt(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Ct(t,e,n){return(Ct=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Nt:jt).apply(null,arguments)}function Pt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Rt(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Lt(){this.s=this.s,this.o=this.o}var Vt={};Lt.prototype.s=!1,Lt.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,Dt)&&t[Dt]||(t[Dt]=++xt)}(this);delete Vt[t]}},Lt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Mt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Ut=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Ft(t){return Array.prototype.concat.apply([],arguments)}function qt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Bt(t){return/^[\s\xa0]*$/.test(t)}var Qt,Kt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Gt(t,e){return-1!=t.indexOf(e)}function zt(t,e){return t<e?-1:t>e?1:0}t:{var Ht=_t.navigator;if(Ht){var Wt=Ht.userAgent;if(Wt){Qt=Wt;break t}}Qt=""}function $t(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Xt(t){var e={};for(var n in t)e[n]=t[n];return e}var Yt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Jt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Yt.length;o++)n=Yt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Zt(t){return Zt[" "](t),t}Zt[" "]=St;var te,ee,ne=Gt(Qt,"Opera"),re=Gt(Qt,"Trident")||Gt(Qt,"MSIE"),ie=Gt(Qt,"Edge"),oe=ie||re,se=Gt(Qt,"Gecko")&&!(Gt(Qt.toLowerCase(),"webkit")&&!Gt(Qt,"Edge"))&&!(Gt(Qt,"Trident")||Gt(Qt,"MSIE"))&&!Gt(Qt,"Edge"),ae=Gt(Qt.toLowerCase(),"webkit")&&!Gt(Qt,"Edge");function ue(){var t=_t.document;return t?t.documentMode:void 0}t:{var ce="",he=(ee=Qt,se?/rv:([^\);]+)(\)|;)/.exec(ee):ie?/Edge\/([\d\.]+)/.exec(ee):re?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ee):ae?/WebKit\/(\S+)/.exec(ee):ne?/(?:Version)[ \/]?(\S+)/.exec(ee):void 0);if(he&&(ce=he?he[1]:""),re){var le=ue();if(null!=le&&le>parseFloat(ce)){te=String(le);break t}}te=ce}var fe={};var de=_t.document&&re&&(ue()||parseInt(te,10))||void 0,pe=function(){if(!_t.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_t.addEventListener("test",St,e),_t.removeEventListener("test",St,e)}catch(n){}return t}();function ge(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function ye(t,e){if(ge.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(se){t:{try{Zt(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:me[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ye.Z.h.call(this)}}ge.prototype.h=function(){this.defaultPrevented=!0},Rt(ye,ge);var me={2:"touch",3:"pen",4:"mouse"};ye.prototype.h=function(){ye.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ve="closure_listenable_"+(1e6*Math.random()|0),be=0;function we(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++be,this.ca=this.fa=!1}function Ee(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Ie(t){this.src=t,this.g={},this.h=0}function Te(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=Mt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Ee(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Oe(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Ie.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=Oe(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new we(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var _e="closure_lm_"+(1e6*Math.random()|0),Se={};function Ae(t,e,n,r,i){if(r&&r.once)return De(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ae(t,e[o],n,r,i);return null}return n=Le(n),t&&t[ve]?t.N(e,n,kt(r)?!!r.capture:!!r,i):ke(t,e,n,!1,r,i)}function ke(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=kt(i)?!!i.capture:!!i,a=Pe(t);if(a||(t[_e]=a=new Ie(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Ce;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)pe||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(je(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function De(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)De(t,e[o],n,r,i);return null}return n=Le(n),t&&t[ve]?t.O(e,n,kt(r)?!!r.capture:!!r,i):ke(t,e,n,!0,r,i)}function xe(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)xe(t,e[o],n,r,i);else r=kt(r)?!!r.capture:!!r,n=Le(n),t&&t[ve]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Oe(o=t.g[e],n,r,i))&&(Ee(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--))):t&&(t=Pe(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Oe(e,n,r,i)),(n=-1<t?e[t]:null)&&Ne(n))}function Ne(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[ve])Te(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(je(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Pe(e))?(Te(n,t),0==n.h&&(n.src=null,e[_e]=null)):Ee(t)}}}function je(t){return t in Se?Se[t]:Se[t]="on"+t}function Ce(t,e){if(t.ca)t=!0;else{e=new ye(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Ne(t),t=n.call(r,e)}return t}function Pe(t){return(t=t[_e])instanceof Ie?t:null}var Re="__closure_events_fn_"+(1e9*Math.random()>>>0);function Le(t){return"function"==typeof t?t:(t[Re]||(t[Re]=function(e){return t.handleEvent(e)}),t[Re])}function Ve(){Lt.call(this),this.i=new Ie(this),this.P=this,this.I=null}function Me(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new ge(e,t);else if(e instanceof ge)e.target=e.target||t;else{var i=e;Jt(e=new ge(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=Ue(s,r,!0,e)&&i}if(i=Ue(s=e.g=t,r,!0,e)&&i,i=Ue(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Ue(s=e.g=n[o],r,!1,e)&&i}function Ue(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&Te(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Rt(Ve,Lt),Ve.prototype[ve]=!0,Ve.prototype.removeEventListener=function(t,e,n,r){xe(this,t,e,n,r)},Ve.prototype.M=function(){if(Ve.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Ee(n[r]);delete e.g[t],e.h--}}this.I=null},Ve.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Ve.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Fe=_t.JSON.stringify;function qe(){var t=$e,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Be,Qe=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=Ke.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),Ke=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,this.g=(t=this.g).next,t.next=null):t=this.i(),t},t}())(function(){return new Ge},function(t){return t.reset()}),Ge=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function ze(t){_t.setTimeout(function(){throw t},0)}function He(t,e){Be||function(){var t=_t.Promise.resolve(void 0);Be=function(){t.then(Xe)}}(),We||(Be(),We=!0),$e.add(t,e)}var We=!1,$e=new Qe;function Xe(){for(var t;t=qe();){try{t.h.call(t.g)}catch(n){ze(n)}var e=Ke;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}We=!1}function Ye(t,e){Ve.call(this),this.h=t||1,this.g=e||_t,this.j=Ct(this.kb,this),this.l=Date.now()}function Je(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Ze(t,e,n){if("function"==typeof t)n&&(t=Ct(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Ct(t.handleEvent,t)}return 2147483647<Number(e)?-1:_t.setTimeout(t,e||0)}function tn(t){t.g=Ze(function(){t.g=null,t.i&&(t.i=!1,tn(t))},t.j);var e=t.h;t.h=null,t.m.apply(null,e)}Rt(Ye,Ve),(It=Ye.prototype).da=!1,It.S=null,It.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Me(this,"tick"),this.da&&(Je(this),this.start()))}},It.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},It.M=function(){Ye.Z.M.call(this),Je(this),delete this.g};var en=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}wt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:tn(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(_t.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(Lt);function nn(t){Lt.call(this),this.h=t,this.g={}}Rt(nn,Lt);var rn=[];function on(t,e,n,r){Array.isArray(n)||(n&&(rn[0]=n.toString()),n=rn);for(var i=0;i<n.length;i++){var o=Ae(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function sn(t){$t(t.g,function(t,e){this.g.hasOwnProperty(e)&&Ne(t)},t),t.g={}}function an(){this.g=!0}function un(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Fe(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}nn.prototype.M=function(){nn.Z.M.call(this),sn(this)},nn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},an.prototype.Aa=function(){this.g=!1},an.prototype.info=function(){};var cn={},hn=null;function ln(){return hn=hn||new Ve}function fn(t){ge.call(this,cn.Ma,t)}function dn(t){var e=ln();Me(e,new fn(e,t))}function pn(t,e){ge.call(this,cn.STAT_EVENT,t),this.stat=e}function gn(t){var e=ln();Me(e,new pn(e,t))}function yn(t,e){ge.call(this,cn.Na,t),this.size=e}function mn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return _t.setTimeout(function(){t()},e)}cn.Ma="serverreachability",Rt(fn,ge),cn.STAT_EVENT="statevent",Rt(pn,ge),cn.Na="timingevent",Rt(yn,ge);var vn={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},bn={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function wn(){}function En(){}wn.prototype.h=null;var In,Tn={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function On(){ge.call(this,"d")}function _n(){ge.call(this,"c")}function Sn(){}function An(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new nn(this),this.P=Dn,this.W=new Ye(t=oe?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new kn}function kn(){this.i=null,this.g="",this.h=!1}Rt(On,ge),Rt(_n,ge),Rt(Sn,wn),Sn.prototype.g=function(){return new XMLHttpRequest},Sn.prototype.i=function(){return{}},In=new Sn;var Dn=45e3,xn={},Nn={};function jn(t,e,n){t.K=1,t.v=er($n(e)),t.s=n,t.U=!0,Cn(t,null)}function Cn(t,e){t.F=Date.now(),Vn(t),t.A=$n(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),pr(n.h,"t",r),t.C=0,n=t.l.H,t.h=new kn,t.g=gi(t.l,n?e:null,!t.s),0<t.O&&(t.L=new en(Ct(t.Ia,t,t.g),t.O)),on(t.V,t.g,"readystatechange",t.gb),e=t.H?Xt(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),dn(1),function(t,e,n,r,i,o){t.info(function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.j,t.u,t.A,t.m,t.X,t.s)}function Pn(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function Rn(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Ln(t,n))==Nn){4==e&&(t.o=4,gn(14),i=!1),un(t.j,t.m,null,"[Incomplete Response]");break}if(r==xn){t.o=4,gn(15),un(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}un(t.j,t.m,r,null),Bn(t,r)}Pn(t)&&r!=Nn&&r!=xn&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,gn(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),ai(e),e.L=!0,gn(11))):(un(t.j,t.m,n,"[Invalid Chunked Response]"),qn(t),Fn(t))}function Ln(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Nn:(n=Number(e.substring(n,r)),isNaN(n)?xn:(r+=1)+n>e.length?Nn:(e=e.substr(r,n),t.C=r+n,e))}function Vn(t){t.Y=Date.now()+t.P,Mn(t,t.P)}function Mn(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=mn(Ct(t.eb,t),e)}function Un(t){t.B&&(_t.clearTimeout(t.B),t.B=null)}function Fn(t){0==t.l.G||t.I||hi(t.l,t)}function qn(t){Un(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Je(t.W),sn(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Bn(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Er(n.i,t)))if(n.I=t.N,!t.J&&Er(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;ci(n),Jr(n)}si(n),gn(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=mn(Ct(n.ab,n),6e3));if(1>=wr(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else fi(n,11)}else if((t.J||n.g==t)&&ci(n),!Bt(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(Gt(h,"spdy")||Gt(h,"quic")||Gt(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(Ir(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,tr(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=t;if((r=n).oa=pi(r,r.H?r.la:null,r.W),d.J){Tr(r.i,d);var p=d,g=r.K;g&&p.setTimeout(g),p.B&&(Un(p),Vn(p)),r.g=d}else oi(r);0<n.l.length&&ei(n)}else"stop"!=o[0]&&"close"!=o[0]||fi(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?fi(n,7):Yr(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}dn(4)}catch(o){}}function Qn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(At(t)||"string"==typeof t)Ut(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(At(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(At(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Kn(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Kn)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Gn(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];zn(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)zn(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function zn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(It=An.prototype).setTimeout=function(t){this.P=t},It.gb=function(t){t=t.target;var e=this.L;e&&3==zr(t)?e.l():this.Ia(t)},It.Ia=function(t){try{if(t==this.g)t:{var e=zr(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||oe||this.g&&(this.h.h||this.g.ga()||Hr(this.g)))){this.I||4!=e||7==n||dn(8==n||0>=r?3:2),Un(this);var i=this.g.ba();this.N=i;e:if(Pn(this)){var o=Hr(this.g);t="";var s=o.length,a=4==zr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){qn(this),Fn(this);var u="";break e}this.h.i=new _t.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Bt(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,gn(12),qn(this),Fn(this);break t}un(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Bn(this,i)}this.U?(Rn(this,e,u),oe&&this.i&&3==e&&(on(this.V,this.W,"tick",this.fb),this.W.start())):(un(this.j,this.m,u,null),Bn(this,u)),4==e&&qn(this),this.i&&!this.I&&(4==e?hi(this.l,this):(this.i=!1,Vn(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,gn(12)):(this.o=0,gn(13)),qn(this),Fn(this)}}}catch(e){}},It.fb=function(){if(this.g){var t=zr(this.g),e=this.g.ga();this.C<e.length&&(Un(this),Rn(this,t,e),this.i&&4!=t&&Vn(this))}},It.cancel=function(){this.I=!0,qn(this)},It.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(dn(3),gn(17)),qn(this),this.o=2,Fn(this)):Mn(this,this.Y-t)},(It=Kn.prototype).R=function(){Gn(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},It.T=function(){return Gn(this),this.g.concat()},It.get=function(t,e){return zn(this.h,t)?this.h[t]:e},It.set=function(t,e){zn(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},It.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Hn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Wn(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Wn){this.g=void 0!==e?e:t.g,Xn(this,t.j),this.s=t.s,Yn(this,t.i),Jn(this,t.m),this.l=t.l,e=t.h;var n=new hr;n.i=e.i,e.g&&(n.g=new Kn(e.g),n.h=e.h),Zn(this,n),this.o=t.o}else t&&(n=String(t).match(Hn))?(this.g=!!e,Xn(this,n[1]||"",!0),this.s=nr(n[2]||""),Yn(this,n[3]||"",!0),Jn(this,n[4]),this.l=nr(n[5]||"",!0),Zn(this,n[6]||"",!0),this.o=nr(n[7]||"")):(this.g=!!e,this.h=new hr(null,this.g))}function $n(t){return new Wn(t)}function Xn(t,e,n){t.j=n?nr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Yn(t,e,n){t.i=n?nr(e,!0):e}function Jn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Zn(t,e,n){e instanceof hr?(t.h=e,function(t,e){e&&!t.j&&(lr(t),t.i=null,t.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fr(this,e),pr(this,n,t))},t)),t.j=e}(t.h,t.g)):(n||(e=rr(e,ur)),t.h=new hr(e,t.g))}function tr(t,e,n){t.h.set(e,n)}function er(t){return tr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function nr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rr(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ir),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ir(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Wn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(rr(e,or,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(rr(e,or,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(rr(n,"/"==n.charAt(0)?ar:sr,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",rr(n,cr)),t.join("")};var or=/[#\/\?@]/g,sr=/[#\?:]/g,ar=/[#\?]/g,ur=/[#\?@]/g,cr=/#/g;function hr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function lr(t){t.g||(t.g=new Kn,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function fr(t,e){lr(t),e=gr(t,e),zn(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,zn((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Gn(t)))}function dr(t,e){return lr(t),e=gr(t,e),zn(t.g.h,e)}function pr(t,e,n){fr(t,e),0<n.length&&(t.i=null,t.g.set(gr(t,e),qt(n)),t.h+=n.length)}function gr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(It=hr.prototype).add=function(t,e){lr(this),this.i=null,t=gr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},It.forEach=function(t,e){lr(this),this.g.forEach(function(n,r){Ut(n,function(n){t.call(e,n,r,this)},this)},this)},It.T=function(){lr(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},It.R=function(t){lr(this);var e=[];if("string"==typeof t)dr(this,t)&&(e=Ft(e,this.g.get(gr(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Ft(e,t[n])}return e},It.set=function(t,e){return lr(this),this.i=null,dr(this,t=gr(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},It.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},It.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var yr=function(){return function(t,e){this.h=t,this.g=e}}();function mr(t){this.l=t||vr,t=_t.PerformanceNavigationTiming?0<(t=_t.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_t.g&&_t.g.Ea&&_t.g.Ea()&&_t.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var vr=10;function br(t){return!!t.h||!!t.g&&t.g.size>=t.j}function wr(t){return t.h?1:t.g?t.g.size:0}function Er(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Ir(t,e){t.g?t.g.add(e):t.h=e}function Tr(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Or(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Et(t.g.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.D)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return qt(t.i)}function _r(){}function Sr(){this.g=new _r}function Ar(t,e,n){var r=n||"";try{Qn(t,function(t,n){var i=t;kt(t)&&(i=Fe(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(Lp){throw e.push(r+"type="+encodeURIComponent("_badmap")),Lp}}function kr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}function Dr(t){this.l=t.$b||null,this.j=t.ib||!1}function xr(t,e){Ve.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Nr,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}mr.prototype.cancel=function(){var t,e;if(this.i=Or(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Et(this.g.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},_r.prototype.stringify=function(t){return _t.JSON.stringify(t,void 0)},_r.prototype.parse=function(t){return _t.JSON.parse(t,void 0)},Rt(Dr,wn),Dr.prototype.g=function(){return new xr(this.l,this.j)},Dr.prototype.i=function(t){return function(){return t}}({}),Rt(xr,Ve);var Nr=0;function jr(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Cr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Pr(t)}function Pr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(It=xr.prototype).open=function(t,e){if(this.readyState!=Nr)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Pr(this)},It.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||_t).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},It.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Cr(this)),this.readyState=Nr},It.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Pr(this)),this.g&&(this.readyState=3,Pr(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==_t.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;jr(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},It.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Cr(this):Pr(this),3==this.readyState&&jr(this)}},It.Ua=function(t){this.g&&(this.response=this.responseText=t,Cr(this))},It.Ta=function(t){this.g&&(this.response=t,Cr(this))},It.ha=function(){this.g&&Cr(this)},It.setRequestHeader=function(t,e){this.v.append(t,e)},It.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},It.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(xr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Rr=_t.JSON.parse;function Lr(t){Ve.call(this),this.headers=new Kn,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Vr,this.K=this.L=!1}Rt(Lr,Ve);var Vr="",Mr=/^https?$/i,Ur=["POST","PUT"];function Fr(t){return"content-type"==t.toLowerCase()}function qr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Br(t),Kr(t)}function Br(t){t.D||(t.D=!0,Me(t,"complete"),Me(t,"error"))}function Qr(t){if(t.h&&void 0!==Ot&&(!t.C[1]||4!=zr(t)||2!=t.ba()))if(t.v&&4==zr(t))Ze(t.Fa,0,t);else if(Me(t,"readystatechange"),4==zr(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(Hn)[1]||null;if(!o&&_t.self&&_t.self.location){var s=_t.self.location.protocol;o=s.substr(0,s.length-1)}i=!Mr.test(o?o.toLowerCase():"")}e=i}if(e)Me(t,"complete"),Me(t,"success");else{t.m=6;try{var a=2<zr(t)?t.g.statusText:""}catch(u){a=""}t.j=a+" ["+t.ba()+"]",Br(t)}}finally{Kr(t)}}}function Kr(t,e){if(t.g){Gr(t);var n=t.g,r=t.C[0]?St:null;t.g=null,t.C=null,e||Me(t,"ready");try{n.onreadystatechange=r}catch(Lp){}}}function Gr(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(_t.clearTimeout(t.A),t.A=null)}function zr(t){return t.g?t.g.readyState:0}function Hr(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Vr:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Wr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return $t(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tr(t,e,n))}function $r(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xr(t){this.za=0,this.l=[],this.h=new an,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=$r("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=$r("baseRetryDelayMs",5e3,t),this.$a=$r("retryDelaySeedMs",1e4,t),this.Ya=$r("forwardChannelMaxRetries",2,t),this.ra=$r("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new mr(t&&t.concurrentRequestLimit),this.Ca=new Sr,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Yr(t){if(Zr(t),3==t.G){var e=t.V++,n=$n(t.F);tr(n,"SID",t.J),tr(n,"RID",e),tr(n,"TYPE","terminate"),ri(t,n),(e=new An(t,t.h,e,void 0)).K=2,e.v=er($n(n)),n=!1,_t.navigator&&_t.navigator.sendBeacon&&(n=_t.navigator.sendBeacon(e.v.toString(),"")),!n&&_t.Image&&((new Image).src=e.v,n=!0),n||(e.g=gi(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Vn(e)}di(t)}function Jr(t){t.g&&(ai(t),t.g.cancel(),t.g=null)}function Zr(t){Jr(t),t.u&&(_t.clearTimeout(t.u),t.u=null),ci(t),t.i.cancel(),t.m&&("number"==typeof t.m&&_t.clearTimeout(t.m),t.m=null)}function ti(t,e){t.l.push(new yr(t.Za++,e)),3==t.G&&ei(t)}function ei(t){br(t.i)||t.m||(t.m=!0,He(t.Ha,t),t.C=0)}function ni(t,e){var n;n=e?e.m:t.V++;var r=$n(t.F);tr(r,"SID",t.J),tr(r,"RID",n),tr(r,"AID",t.U),ri(t,r),t.o&&t.s&&Wr(r,t.o,t.s),n=new An(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=ii(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Ir(t.i,n),jn(n,r,e)}function ri(t,e){t.j&&Qn({},function(t,n){tr(e,n,t)})}function ii(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Ct(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].h)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{Ar(h,s,"req"+c+"_")}catch($i){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function oi(t){t.g||t.u||(t.Y=1,He(t.Ga,t),t.A=0)}function si(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=mn(Ct(t.Ga,t),li(t,t.A)),t.A++,0))}function ai(t){null!=t.B&&(_t.clearTimeout(t.B),t.B=null)}function ui(t){t.g=new An(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=$n(t.oa);tr(e,"RID","rpc"),tr(e,"SID",t.J),tr(e,"CI",t.N?"0":"1"),tr(e,"AID",t.U),ri(t,e),tr(e,"TYPE","xmlhttp"),t.o&&t.s&&Wr(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=er($n(e)),n.s=null,n.U=!0,Cn(n,t)}function ci(t){null!=t.v&&(_t.clearTimeout(t.v),t.v=null)}function hi(t,e){var n=null;if(t.g==e){ci(t),ai(t),t.g=null;var r=2}else{if(!Er(t.i,e))return;n=e.D,Tr(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Me(r=ln(),new yn(r,n,e,i)),ei(t)}else oi(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(wr(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=mn(Ct(t.Ha,t,e),li(t,t.C)),t.C++,0)))}(t,e)||2==r&&si(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:fi(t,5);break;case 4:fi(t,10);break;case 3:fi(t,6);break;default:fi(t,2)}}function li(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function fi(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=Ct(t.jb,t);n||(n=new Wn("//www.google.com/images/cleardot.gif"),_t.location&&"http"==_t.location.protocol||Xn(n,"https"),er(n)),function(t,e){var n=new an;if(_t.Image){var r=new Image;r.onload=Pt(kr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Pt(kr,n,r,"TestLoadImage: error",!1,e),r.onabort=Pt(kr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Pt(kr,n,r,"TestLoadImage: timeout",!1,e),_t.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else gn(2);t.G=0,t.j&&t.j.va(e),di(t),Zr(t)}function di(t){t.G=0,t.I=-1,t.j&&(0==Or(t.i).length&&0==t.l.length||(t.i.i.length=0,qt(t.l),t.l.length=0),t.j.ua())}function pi(t,e,n){var r=function(t){return t instanceof Wn?$n(t):new Wn(t,void 0)}(n);if(""!=r.i)e&&Yn(r,e+"."+r.i),Jn(r,r.m);else{var i=_t.location;r=function(t,e,n,r){var i=new Wn(null,void 0);return t&&Xn(i,t),e&&Yn(i,e),n&&Jn(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&$t(t.aa,function(t,e){tr(r,e,t)}),n=t.sa,(e=t.D)&&n&&tr(r,e,n),tr(r,"VER",t.ma),ri(t,r),r}function gi(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Lr(n&&t.Ba&&!t.qa?new Dr({ib:!0}):t.qa)).L=t.H,e}function yi(){}function mi(){if(re&&!(10<=Number(de)))throw Error("Environmental error: no available transport.")}function vi(t,e){Ve.call(this),this.g=new Xr(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Bt(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Bt(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Ei(this)}function bi(t){On.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function wi(){_n.call(this),this.status=1}function Ei(t){this.g=t}(It=Lr.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():In.g(),this.C=function(t){return t.h||(t.h=t.i())}(this.u?this.u:In),this.g.onreadystatechange=Ct(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){return void qr(this,o)}t=n||"";var i=new Kn(this.headers);r&&Qn(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Fr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=_t.FormData&&t instanceof _t.FormData,!(0<=Mt(Ur,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.g.setRequestHeader(e,t)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Gr(this),0<this.B&&((this.K=function(t){return re&&function(){return t=fe,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){for(var t=0,e=Kt(String(te)).split("."),n=Kt("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=zt(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||zt(0==o[2].length,0==s[2].length)||zt(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}();var t}()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ct(this.pa,this)):this.A=Ze(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){qr(this,o)}},It.pa=function(){void 0!==Ot&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Me(this,"timeout"),this.abort(8))},It.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Me(this,"complete"),Me(this,"abort"),Kr(this))},It.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Kr(this,!0)),Lr.Z.M.call(this)},It.Fa=function(){this.s||(this.F||this.v||this.l?Qr(this):this.cb())},It.cb=function(){Qr(this)},It.ba=function(){try{return 2<zr(this)?this.g.status:-1}catch(ee){return-1}},It.ga=function(){try{return this.g?this.g.responseText:""}catch(ee){return""}},It.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rr(e)}},It.Da=function(){return this.m},It.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(It=Xr.prototype).ma=8,It.G=1,It.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},It.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new An(this,this.h,t,void 0),n=this.s;if(this.P&&(n?Jt(n=Xt(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=ii(this,e,r),tr(i=$n(this.F),"RID",t),tr(i,"CVER",22),this.D&&tr(i,"X-HTTP-Session-Id",this.D),ri(this,i),this.o&&n&&Wr(i,this.o,n),Ir(this.i,e),this.Ra&&tr(i,"TYPE","init"),this.ja?(tr(i,"$req",r),tr(i,"SID","null"),e.$=!0,jn(e,i,null)):jn(e,i,r),this.G=2}}else 3==this.G&&(t?ni(this,t):0==this.l.length||br(this.i)||ni(this))},It.Ga=function(){if(this.u=null,ui(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=mn(Ct(this.bb,this),t)}},It.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,gn(10),Jr(this),ui(this))},It.ab=function(){null!=this.v&&(this.v=null,Jr(this),si(this),gn(19))},It.jb=function(t){t?(this.h.info("Successfully pinged google.com"),gn(2)):(this.h.info("Failed to ping google.com"),gn(1))},(It=yi.prototype).xa=function(){},It.wa=function(){},It.va=function(){},It.ua=function(){},It.Oa=function(){},mi.prototype.g=function(t,e){return new vi(t,e)},Rt(vi,Ve),vi.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),He(Ct(t.hb,t,e))),gn(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=pi(t,null,t.W),ei(t)},vi.prototype.close=function(){Yr(this.g)},vi.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,ti(this.g,e)}else this.v?((e={}).__data__=Fe(t),ti(this.g,e)):ti(this.g,t)},vi.prototype.M=function(){this.g.j=null,delete this.j,Yr(this.g),delete this.g,vi.Z.M.call(this)},Rt(bi,On),Rt(wi,_n),Rt(Ei,yi),Ei.prototype.xa=function(){Me(this.g,"a")},Ei.prototype.wa=function(t){Me(this.g,new bi(t))},Ei.prototype.va=function(t){Me(this.g,new wi(t))},Ei.prototype.ua=function(){Me(this.g,"b")},mi.prototype.createWebChannel=mi.prototype.g,vi.prototype.send=vi.prototype.u,vi.prototype.open=vi.prototype.m,vi.prototype.close=vi.prototype.close,vn.NO_ERROR=0,vn.TIMEOUT=8,vn.HTTP_ERROR=6,bn.COMPLETE="complete",En.EventType=Tn,Tn.OPEN="a",Tn.CLOSE="b",Tn.ERROR="c",Tn.MESSAGE="d",Ve.prototype.listen=Ve.prototype.N,Lr.prototype.listenOnce=Lr.prototype.O,Lr.prototype.getLastError=Lr.prototype.La,Lr.prototype.getLastErrorCode=Lr.prototype.Da,Lr.prototype.getStatus=Lr.prototype.ba,Lr.prototype.getResponseJson=Lr.prototype.Qa,Lr.prototype.getResponseText=Lr.prototype.ga,Lr.prototype.send=Lr.prototype.ea;var Ii=vn,Ti=bn,Oi=cn,_i=Dr,Si=En,Ai=Lr,ki=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();ki.o=-1;var Di={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},xi=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(mt.c)(e,t),e}(Error),Ni=new bt.b("@firebase/firestore");function ji(){return Ni.logLevel}function Ci(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ni.logLevel<=bt.a.DEBUG){var r=e.map(Li);Ni.debug.apply(Ni,Object(mt.f)(["Firestore (8.7.0): "+t],r))}}function Pi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ni.logLevel<=bt.a.ERROR){var r=e.map(Li);Ni.error.apply(Ni,Object(mt.f)(["Firestore (8.7.0): "+t],r))}}function Ri(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ni.logLevel<=bt.a.WARN){var r=e.map(Li);Ni.warn.apply(Ni,Object(mt.f)(["Firestore (8.7.0): "+t],r))}}function Li(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(Lp){return t}}function Vi(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.7.0) INTERNAL ASSERTION FAILED: "+t;throw Pi(e),new Error(e)}function Mi(t,e){t||Vi()}function Ui(t,e){return t}function Fi(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var qi=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Fi(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Bi(t,e){return t<e?-1:t>e?1:0}function Qi(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Ki(t){return t+"\0"}var Gi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new xi(Di.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new xi(Di.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new xi(Di.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new xi(Di.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Bi(this.nanoseconds,t.nanoseconds):Bi(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),zi=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Gi(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function Hi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Wi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $i(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Xi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Vi(),void 0===n?n=t.length-e:n>t.length-e&&Vi(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Yi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(mt.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new xi(Di.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Xi),Ji=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(mt.c)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Ji.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new xi(Di.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new xi(Di.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new xi(Di.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new xi(Di.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Xi),to=function(){function t(t){this.fields=t,t.sort(Zi.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Qi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),eo=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.binaryString)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Bi(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();eo.EMPTY_BYTE_STRING=new eo("");var no=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ro(t){if(Mi(!!t),"string"==typeof t){var e=0,n=no.exec(t);if(Mi(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:io(t.seconds),nanos:io(t.nanos)}}function io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function oo(t){return"string"==typeof t?eo.fromBase64String(t):eo.fromUint8Array(t)}function so(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ao(t){var e=t.mapValue.fields.__previous_value__;return so(e)?ao(e):e}function uo(t){var e=ro(t.mapValue.fields.__local_write_time__.timestampValue);return new Gi(e.seconds,e.nanos)}function co(t){return null==t}function ho(t){return 0===t&&1/t==-1/0}function lo(t){return"number"==typeof t&&Number.isInteger(t)&&!ho(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var fo=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(Yi.fromString(e))},t.fromName=function(e){return new t(Yi.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Yi.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Yi.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Yi(e.slice()))},t}();function po(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?so(t)?4:10:Vi()}function go(t,e){var n=po(t);if(n!==po(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return uo(t).isEqual(uo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ro(t.timestampValue),r=ro(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return oo(t.bytesValue).isEqual(oo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return io(t.geoPointValue.latitude)===io(e.geoPointValue.latitude)&&io(t.geoPointValue.longitude)===io(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return io(t.integerValue)===io(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=io(t.doubleValue),r=io(e.doubleValue);return n===r?ho(n)===ho(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Qi(t.arrayValue.values||[],e.arrayValue.values||[],go);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Hi(n)!==Hi(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!go(n[i],r[i])))return!1;return!0}(t,e);default:return Vi()}}function yo(t,e){return void 0!==(t.values||[]).find(function(t){return go(t,e)})}function mo(t,e){var n=po(t),r=po(e);if(n!==r)return Bi(n,r);switch(n){case 0:return 0;case 1:return Bi(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=io(t.integerValue||t.doubleValue),r=io(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return vo(t.timestampValue,e.timestampValue);case 4:return vo(uo(t),uo(e));case 5:return Bi(t.stringValue,e.stringValue);case 6:return function(t,e){var n=oo(t),r=oo(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Bi(n[i],r[i]);if(0!==o)return o}return Bi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Bi(io(t.latitude),io(e.latitude));return 0!==n?n:Bi(io(t.longitude),io(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return Bi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Bi(r[s],o[s]);if(0!==a)return a;var u=mo(n[r[s]],i[o[s]]);if(0!==u)return u}return Bi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Vi()}}function vo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Bi(t,e);var n=ro(t),r=ro(e),i=Bi(n.seconds,r.seconds);return 0!==i?i:Bi(n.nanos,r.nanos)}function bo(t){return wo(t)}function wo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ro(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?oo(t.bytesValue).toBase64():"referenceValue"in t?fo.fromName(t.referenceValue).toString():"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=wo(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+wo(t.fields[o])}return e+"}"}(t.mapValue):Vi();var e}function Eo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Io(t){return!!t&&"integerValue"in t}function To(t){return!!t&&"arrayValue"in t}function Oo(t){return!!t&&"nullValue"in t}function _o(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function So(t){return!!t&&"mapValue"in t}function Ao(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},ro(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return Wi(t.mapValue.fields,function(t,n){return e.mapValue.fields[t]=Ao(n)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Ao(t.arrayValue.values[r]);return n}return Object.assign({},t)}var ko=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!So(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ao(e)},t.prototype.setAll=function(t){var e=this,n=Zi.emptyPath(),r={},i=[];t.forEach(function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Ao(t):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());So(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return go(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];So(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){Wi(e,function(e,n){return t[e]=n});for(var r=0,i=n;r<i.length;r++)delete t[i[r]]},t.prototype.clone=function(){return new t(Ao(this.value))},t}();function Do(t){var e=[];return Wi(t.fields,function(t,n){var r=new Zi([t]);if(So(n)){var i=Do(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)}),new to(e)}var xo=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,zi.min(),ko.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,ko.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,ko.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=ko.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=ko.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),No=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function jo(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new No(t,e,n,r,i,o,s)}function Co(t){var e=Ui(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.canonicalString()+t.op.toString()+bo(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.canonicalString()+t.dir}(t)}).join(","),co(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=zo(e.startAt)),e.endAt&&(n+="|ub:",n+=zo(e.endAt)),e.h=n}return e.h}function Po(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Wo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if((i=t.filters[r]).op!==(o=e.filters[r]).op||!i.field.isEqual(o.field)||!go(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Xo(t.startAt,e.startAt)&&Xo(t.endAt,e.endAt)}function Ro(t){return fo.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Lo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Object(mt.c)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Vo(t,n,r):"array-contains"===n?new qo(t,r):"in"===n?new Bo(t,r):"not-in"===n?new Qo(t,r):"array-contains-any"===n?new Ko(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Mo(t,n):new Uo(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(mo(e,this.value)):null!==e&&po(this.value)===po(e)&&this.m(mo(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Vi()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Vo=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=fo.fromName(r.referenceValue),i}return Object(mt.c)(e,t),e.prototype.matches=function(t){var e=fo.comparator(t.key,this.key);return this.m(e)},e}(Lo),Mo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Fo(0,n),r}return Object(mt.c)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Lo),Uo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Fo(0,n),r}return Object(mt.c)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Lo);function Fo(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return fo.fromName(t.referenceValue)})}var qo=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Object(mt.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return To(e)&&yo(e.arrayValue,this.value)},e}(Lo),Bo=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Object(mt.c)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&yo(this.value.arrayValue,e)},e}(Lo),Qo=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Object(mt.c)(e,t),e.prototype.matches=function(t){if(yo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!yo(this.value.arrayValue,e)},e}(Lo),Ko=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Object(mt.c)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!To(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return yo(e.value.arrayValue,t)})},e}(Lo),Go=function(t,e){this.position=t,this.before=e};function zo(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return bo(t)}).join(",")}var Ho=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Wo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function $o(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?fo.comparator(fo.fromName(s.referenceValue),n.key):mo(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Xo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!go(t.position[n],e.position[n]))return!1;return!0}var Yo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null};function Jo(t,e,n,r,i,o,s,a){return new Yo(t,e,n,r,i,o,s,a)}function Zo(t){return new Yo(t)}function ts(t){return!co(t.limit)&&"F"===t.limitType}function es(t){return!co(t.limit)&&"L"===t.limitType}function ns(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function rs(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function is(t){return null!==t.collectionGroup}function os(t){var e=Ui(t);if(null===e.p){e.p=[];var n=rs(e),r=ns(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Ho(n)),e.p.push(new Ho(Zi.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Ho(Zi.keyField(),u))}}}return e.p}function ss(t){var e=Ui(t);if(!e.T)if("F"===e.limitType)e.T=jo(e.path,e.collectionGroup,os(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=os(e);r<i.length;r++){var o=i[r];n.push(new Ho(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Go(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Go(e.startAt.position,!e.startAt.before):null;e.T=jo(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.T}function as(t,e,n){return new Yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function us(t,e){return Po(ss(t),ss(e))&&t.limitType===e.limitType}function cs(t){return Co(ss(t))+"|lt:"+t.limitType}function hs(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.canonicalString()+" "+e.op+" "+bo(e.value);var e}).join(", ")+"]"),co(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+zo(t.startAt)),t.endAt&&(e+=", endAt: "+zo(t.endAt)),"Target("+e+")"}(ss(t))+"; limitType="+t.limitType+")"}function ls(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):fo.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!$o(t.startAt,os(t),e)||t.endAt&&$o(t.endAt,os(t),e))}(t,e)}function fs(t){return function(e,n){for(var r=!1,i=0,o=os(t);i<o.length;i++){var s=o[i],a=ds(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function ds(t,e,n){var r=t.field.isKeyField()?fo.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?mo(r,i):Vi()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Vi()}}function ps(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ho(e)?"-0":e}}function gs(t){return{integerValue:""+t}}function ys(t,e){return lo(e)?gs(e):ps(t,e)}var ms=function(){this._=void 0};function vs(t,e,n){return t instanceof Es?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Is?Ts(t,e):t instanceof Os?_s(t,e):function(t,e){var n=ws(t,e),r=As(n)+As(t.A);return Io(n)&&Io(t.A)?gs(r):ps(t.R,r)}(t,e)}function bs(t,e,n){return t instanceof Is?Ts(t,e):t instanceof Os?_s(t,e):n}function ws(t,e){return t instanceof Ss?Io(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Es=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(mt.c)(e,t),e}(ms),Is=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(mt.c)(e,t),e}(ms);function Ts(t,e){for(var n=ks(e),r=function(t){n.some(function(e){return go(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Os=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Object(mt.c)(e,t),e}(ms);function _s(t,e){for(var n=ks(e),r=function(t){n=n.filter(function(e){return!go(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ss=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Object(mt.c)(e,t),e}(ms);function As(t){return io(t.integerValue||t.doubleValue)}function ks(t){return To(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ds=function(t,e){this.field=t,this.transform=e},xs=function(t,e){this.version=t,this.transformResults=e},Ns=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function js(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Cs=function(){};function Ps(t,e,n){t instanceof Us?function(t,e,n){var r=t.value.clone(),i=Bs(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Fs?function(t,e,n){if(js(t.precondition,e)){var r=Bs(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(qs(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Rs(t,e,n){t instanceof Us?function(t,e,n){if(js(t.precondition,e)){var r=t.value.clone(),i=Qs(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Ms(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Fs?function(t,e,n){if(js(t.precondition,e)){var r=Qs(t.fieldTransforms,n,e),i=e.data;i.setAll(qs(t)),i.setAll(r),e.convertToFoundDocument(Ms(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){js(t.precondition,e)&&e.convertToNoDocument(zi.min())}(t,e)}function Ls(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=ws(o.transform,s||null);null!=a&&(null==n&&(n=ko.empty()),n.set(o.field,a))}return n||null}function Vs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Qi(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Is&&e instanceof Is||t instanceof Os&&e instanceof Os?Qi(t.elements,e.elements,go):t instanceof Ss&&e instanceof Ss?go(t.A,e.A):t instanceof Es&&e instanceof Es}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Ms(t){return t.isFoundDocument()?t.version:zi.min()}var Us=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(mt.c)(e,t),e}(Cs),Fs=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Object(mt.c)(e,t),e}(Cs);function qs(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function Bs(t,e,n){var r=new Map;Mi(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,bs(s,a,n[i]))}return r}function Qs(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,vs(a,u,e))}return r}var Ks,Gs,zs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(mt.c)(e,t),e}(Cs),Hs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(mt.c)(e,t),e}(Cs),Ws=function(t){this.count=t};function $s(t){switch(t){case Di.OK:return Vi();case Di.CANCELLED:case Di.UNKNOWN:case Di.DEADLINE_EXCEEDED:case Di.RESOURCE_EXHAUSTED:case Di.INTERNAL:case Di.UNAVAILABLE:case Di.UNAUTHENTICATED:return!1;case Di.INVALID_ARGUMENT:case Di.NOT_FOUND:case Di.ALREADY_EXISTS:case Di.PERMISSION_DENIED:case Di.FAILED_PRECONDITION:case Di.ABORTED:case Di.OUT_OF_RANGE:case Di.UNIMPLEMENTED:case Di.DATA_LOSS:return!0;default:return Vi()}}function Xs(t){if(void 0===t)return Pi("GRPC error has no .code"),Di.UNKNOWN;switch(t){case Ks.OK:return Di.OK;case Ks.CANCELLED:return Di.CANCELLED;case Ks.UNKNOWN:return Di.UNKNOWN;case Ks.DEADLINE_EXCEEDED:return Di.DEADLINE_EXCEEDED;case Ks.RESOURCE_EXHAUSTED:return Di.RESOURCE_EXHAUSTED;case Ks.INTERNAL:return Di.INTERNAL;case Ks.UNAVAILABLE:return Di.UNAVAILABLE;case Ks.UNAUTHENTICATED:return Di.UNAUTHENTICATED;case Ks.INVALID_ARGUMENT:return Di.INVALID_ARGUMENT;case Ks.NOT_FOUND:return Di.NOT_FOUND;case Ks.ALREADY_EXISTS:return Di.ALREADY_EXISTS;case Ks.PERMISSION_DENIED:return Di.PERMISSION_DENIED;case Ks.FAILED_PRECONDITION:return Di.FAILED_PRECONDITION;case Ks.ABORTED:return Di.ABORTED;case Ks.OUT_OF_RANGE:return Di.OUT_OF_RANGE;case Ks.UNIMPLEMENTED:return Di.UNIMPLEMENTED;case Ks.DATA_LOSS:return Di.DATA_LOSS;default:return Vi()}}(Gs=Ks||(Ks={}))[Gs.OK=0]="OK",Gs[Gs.CANCELLED=1]="CANCELLED",Gs[Gs.UNKNOWN=2]="UNKNOWN",Gs[Gs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Gs[Gs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Gs[Gs.NOT_FOUND=5]="NOT_FOUND",Gs[Gs.ALREADY_EXISTS=6]="ALREADY_EXISTS",Gs[Gs.PERMISSION_DENIED=7]="PERMISSION_DENIED",Gs[Gs.UNAUTHENTICATED=16]="UNAUTHENTICATED",Gs[Gs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Gs[Gs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Gs[Gs.ABORTED=10]="ABORTED",Gs[Gs.OUT_OF_RANGE=11]="OUT_OF_RANGE",Gs[Gs.UNIMPLEMENTED=12]="UNIMPLEMENTED",Gs[Gs.INTERNAL=13]="INTERNAL",Gs[Gs.UNAVAILABLE=14]="UNAVAILABLE",Gs[Gs.DATA_LOSS=15]="DATA_LOSS";var Ys=function(){function t(t,e){this.comparator=t,this.root=e||Zs.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Zs.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zs.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.inorderTraversal(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Js(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Js(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Js(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Js(this.root,t,this.comparator,!0)},t}(),Js=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Zs=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Vi();if(this.right.isRed())throw Vi();var t=this.left.check();if(t!==this.right.check())throw Vi();return t+(this.isRed()?0:1)},t}();Zs.EMPTY=null,Zs.RED=!0,Zs.BLACK=!1,Zs.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Vi()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Zs(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var ta=function(){function t(t){this.comparator=t,this.data=new Ys(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new ea(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new ea(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),ea=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),na=new Ys(fo.comparator);function ra(){return na}var ia=new Ys(fo.comparator);function oa(){return ia}var sa=new Ys(fo.comparator);function aa(){return sa}var ua=new ta(fo.comparator);function ca(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ua,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ha=new ta(Bi);function la(){return ha}var fa=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,da.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(zi.min(),r,la(),ra(),ca())},t}(),da=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(eo.EMPTY_BYTE_STRING,n,ca(),ca(),ca())},t}(),pa=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},ga=function(t,e){this.targetId=t,this.V=e},ya=function(t,e,n,r){void 0===n&&(n=eo.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ma=function(){function t(){this.S=0,this.D=wa(),this.C=eo.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=ca(),e=ca(),n=ca();return this.D.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Vi()}}),new da(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=wa()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),va=function(){function t(t){this.W=t,this.G=new Map,this.H=ra(),this.J=ba(),this.Y=new ta(Bi)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.tt(r=o[i],t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Vi()}})},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach(function(t,r){n.st(r)&&e(r)})},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Ro(i))if(0===n){var o=new fo(i.path);this.tt(e,o,xo.newNoDocument(o,zi.min()))}else Mi(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach(function(r,i){var o=e.ot(i);if(o){if(r.current&&Ro(o.target)){var s=new fo(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,xo.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}});var r=ca();this.J.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(t))});var i=new fa(t,n,this.Y,this.H,r);return this.H=ra(),this.J=ba(),this.Y=new ta(Bi),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new ma,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new ta(Bi),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Ci("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new ma),this.W.getRemoteKeysForTarget(t).forEach(function(n){e.tt(t,n,null)})},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function ba(){return new Ys(fo.comparator)}function wa(){return new Ys(fo.comparator)}var Ea={asc:"ASCENDING",desc:"DESCENDING"},Ia={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ta=function(t,e){this.databaseId=t,this.I=e};function Oa(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function _a(t,e){return t.I?e.toBase64():e.toUint8Array()}function Sa(t,e){return Oa(t,e.toTimestamp())}function Aa(t){return Mi(!!t),zi.fromTimestamp(function(t){var e=ro(t);return new Gi(e.seconds,e.nanos)}(t))}function ka(t,e){return function(t){return new Yi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Da(t){var e=Yi.fromString(t);return Mi(Za(e)),e}function xa(t,e){return ka(t.databaseId,e.path)}function Na(t,e){var n=Da(e);if(n.get(1)!==t.databaseId.projectId)throw new xi(Di.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new xi(Di.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new fo(Ra(n))}function ja(t,e){return ka(t.databaseId,e)}function Ca(t){var e=Da(t);return 4===e.length?Yi.emptyPath():Ra(e)}function Pa(t){return new Yi(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ra(t){return Mi(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function La(t,e,n){return{name:xa(t,e),fields:n.value.mapValue.fields}}function Va(t,e,n){var r=Na(t,e.name),i=Aa(e.updateTime),o=new ko({mapValue:{fields:e.fields}}),s=xo.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function Ma(t,e){var n;if(e instanceof Us)n={update:La(t,e.key,e.value)};else if(e instanceof zs)n={delete:xa(t,e.key)};else if(e instanceof Fs)n={update:La(t,e.key,e.data),updateMask:Ja(e.fieldMask)};else{if(!(e instanceof Hs))return Vi();n={verify:xa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof Es)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Is)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Os)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ss)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Vi()}(0,t)})),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Sa(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Vi()}(t,e.precondition)),n}function Ua(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Ns.updateTime(Aa(t.updateTime)):void 0!==t.exists?Ns.exists(t.exists):Ns.none()}(e.currentDocument):Ns.none(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;"setToServerValue"in e?(Mi("REQUEST_TIME"===e.setToServerValue),n=new Es):"appendMissingElements"in e?n=new Is(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Os(e.removeAllFromArray.values||[]):"increment"in e?n=new Ss(t,e.increment):Vi();var r=Zi.fromServerFormat(e.fieldPath);return new Ds(r,n)}(t,e)}):[];if(e.update){var i=Na(t,e.update.name),o=new ko({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){return new to((t.fieldPaths||[]).map(function(t){return Zi.fromServerFormat(t)}))}(e.updateMask);return new Fs(i,o,s,n,r)}return new Us(i,o,n,r)}if(e.delete){var a=Na(t,e.delete);return new zs(a,n)}if(e.verify){var u=Na(t,e.verify);return new Hs(u,n)}return Vi()}function Fa(t,e){return{documents:[ja(t,e.path)]}}function qa(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ja(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ja(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(_o(t.value))return{unaryFilter:{field:Wa(t.field),op:"IS_NAN"}};if(Oo(t.value))return{unaryFilter:{field:Wa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(_o(t.value))return{unaryFilter:{field:Wa(t.field),op:"IS_NOT_NAN"}};if(Oo(t.value))return{unaryFilter:{field:Wa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wa(t.field),op:Ha(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:Wa(t.field),direction:za(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||co(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Ka(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ka(e.endAt)),n}function Ba(t){var e=Ca(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Mi(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Qa(n.where));var a=[];n.orderBy&&(a=n.orderBy.map(function(t){return function(t){return new Ho($a(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var u=null;n.limit&&(u=function(t){var e;return co(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Ga(n.startAt));var h=null;return n.endAt&&(h=Ga(n.endAt)),Jo(e,i,a,s,u,"F",c,h)}function Qa(t){return t?void 0!==t.unaryFilter?[Ya(t)]:void 0!==t.fieldFilter?[Xa(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return Qa(t)}).reduce(function(t,e){return t.concat(e)}):Vi():[]}function Ka(t){return{before:t.before,values:t.position}}function Ga(t){return new Go(t.values||[],!!t.before)}function za(t){return Ea[t]}function Ha(t){return Ia[t]}function Wa(t){return{fieldPath:t.canonicalString()}}function $a(t){return Zi.fromServerFormat(t.fieldPath)}function Xa(t){return Lo.create($a(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Vi()}}(t.fieldFilter.op),t.fieldFilter.value)}function Ya(t){switch(t.unaryFilter.op){case"IS_NAN":var e=$a(t.unaryFilter.field);return Lo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=$a(t.unaryFilter.field);return Lo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=$a(t.unaryFilter.field);return Lo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=$a(t.unaryFilter.field);return Lo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Vi()}}function Ja(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}}function Za(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function tu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=nu(e)),e=eu(t.get(n),e);return nu(e)}function eu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function nu(t){return t+"\x01\x01"}function ru(t){var e=t.length;if(Mi(e>=2),2===e)return Mi("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),Yi.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&Vi(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Vi()}o=s+2}return new Yi(r)}var iu=function(t,e){this.seconds=t,this.nanoseconds=e},ou=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};ou.store="owner",ou.key="owner";var su=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};su.store="mutationQueues",su.keyPath="userId";var au=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};au.store="mutations",au.keyPath="batchId",au.userMutationsIndex="userMutationsIndex",au.userMutationsKeyPath=["userId","batchId"];var uu=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,tu(e)]},t.key=function(t,e,n){return[t,tu(e),n]},t}();uu.store="documentMutations",uu.PLACEHOLDER=new uu;var cu=function(t,e){this.path=t,this.readTime=e},hu=function(t,e){this.path=t,this.version=e},lu=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};lu.store="remoteDocuments",lu.readTimeIndex="readTimeIndex",lu.readTimeIndexPath="readTime",lu.collectionReadTimeIndex="collectionReadTimeIndex",lu.collectionReadTimeIndexPath=["parentPath","readTime"];var fu=function(t){this.byteSize=t};fu.store="remoteDocumentGlobal",fu.key="remoteDocumentGlobalKey";var du=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};du.store="targets",du.keyPath="targetId",du.queryTargetsIndexName="queryTargetsIndex",du.queryTargetsKeyPath=["canonicalId","targetId"];var pu=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};pu.store="targetDocuments",pu.keyPath=["targetId","path"],pu.documentTargetsIndex="documentTargetsIndex",pu.documentTargetsKeyPath=["path","targetId"];var gu=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};gu.key="targetGlobalKey",gu.store="targetGlobal";var yu=function(t,e){this.collectionId=t,this.parent=e};yu.store="collectionParents",yu.keyPath=["collectionId","parent"];var mu=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};mu.store="clientMetadata",mu.keyPath="clientId";var vu=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};vu.store="bundles",vu.keyPath="bundleId";var bu=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};bu.store="namedQueries",bu.keyPath="name";var wu=Object(mt.f)(Object(mt.f)([],Object(mt.f)(Object(mt.f)([],Object(mt.f)(Object(mt.f)([],Object(mt.f)(Object(mt.f)([],[su.store,au.store,uu.store,lu.store,du.store,ou.store,gu.store,pu.store]),[mu.store])),[fu.store])),[yu.store])),[vu.store,bu.store]),Eu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Iu=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},t}(),Tu=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},Ou=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Vi(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),_u=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Tu,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new ku(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Cu(e.target.error);n.ft.reject(new ku(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new ku(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Ci("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new xu(e)},t}(),Su=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Object(vt.i)())&&Pi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Ci("SimpleDb","Removing database:",t),Nu(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Object(vt.i)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Object(mt.b)(this,void 0,void 0,function(){var e,n=this;return Object(mt.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Ci("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){e(t.target.result)},i.onblocked=function(){r(new ku(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;r("VersionError"===n.name?new xi(Di.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new ku(t,n))},i.onupgradeneeded=function(t){Ci("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion),n.wt.Rt(t.target.result,i.transaction,t.oldVersion,n.version).next(function(){Ci("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}})})},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Object(mt.b)(this,void 0,void 0,function(){var i,o,s,a,u;return Object(mt.d)(this,function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Object(mt.d)(this,function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=_u.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch(function(t){return e.abort(t),Ou.reject(t)}).toPromise(),u={},s.catch(function(){}),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return Ci("SimpleDb","Transaction failed with error:",(c=l.sent()).message,"Retrying:",h="FirebaseError"!==c.name&&o<3),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Au=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Nu(this.Pt.delete())},t}(),ku=function(t){function e(e,n){var r=this;return(r=t.call(this,Di.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(mt.c)(e,t),e}(xi);function Du(t){return"IndexedDbTransactionError"===t.name}var xu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Ci("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Ci("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Nu(n)},t.prototype.add=function(t){return Ci("SimpleDb","ADD",this.store.name,t,t),Nu(this.store.add(t))},t.prototype.get=function(t){var e=this;return Nu(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Ci("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Ci("SimpleDb","DELETE",this.store.name,t),Nu(this.store.delete(t))},t.prototype.count=function(){return Ci("SimpleDb","COUNT",this.store.name),Nu(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.Ft=function(t,e){Ci("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,function(t,e,n){return n.delete()})},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Ou(function(n,r){e.onerror=function(t){var e=Cu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.xt=function(t,e){var n=[];return new Ou(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Au(i),s=e(i.primaryKey,i.value,o);if(s instanceof Ou){var a=s.catch(function(t){return o.done(),Ou.reject(t)});n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return Ou.waitFor(n)})},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Nu(t){return new Ou(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=Cu(t.target.error);n(e)}})}var ju=!1;function Cu(t){var e=Su._t(Object(vt.i)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new xi("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ju||(ju=!0,setTimeout(function(){throw r},0)),r}}return t}var Pu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Object(mt.c)(e,t),e}(Iu);function Ru(t,e){var n=Ui(t);return Su.It(n.Mt,e)}var Lu=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Ps(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Rs(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Rs(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach(function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(zi.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ca())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Qi(this.mutations,t.mutations,function(t,e){return Vs(t,e)})&&Qi(this.baseMutations,t.baseMutations,function(t,e){return Vs(t,e)})},t}(),Vu=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Mi(e.mutations.length===r.length);for(var i=aa(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Mu=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=zi.min()),void 0===o&&(o=zi.min()),void 0===s&&(s=eo.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Uu=function(t){this.Lt=t};function Fu(t,e){if(e.document)return Va(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=fo.fromSegments(e.noDocument.path),r=Gu(e.noDocument.readTime),i=xo.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=fo.fromSegments(e.unknownDocument.path);return r=Gu(e.unknownDocument.version),xo.newUnknownDocument(o,r)}return Vi()}function qu(t,e,n){var r=Bu(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:xa(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Oa(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new lu(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=Ku(e.version);return s=e.hasCommittedMutations,new lu(null,new cu(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Ku(e.version);return new lu(new hu(c,h),null,null,!0,r,i)}return Vi()}function Bu(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Qu(t){var e=new Gi(t[0],t[1]);return zi.fromTimestamp(e)}function Ku(t){var e=t.toTimestamp();return new iu(e.seconds,e.nanoseconds)}function Gu(t){var e=new Gi(t.seconds,t.nanoseconds);return zi.fromTimestamp(e)}function zu(t,e){for(var n=(e.baseMutations||[]).map(function(e){return Ua(t.Lt,e)}),r=0;r<e.mutations.length-1;++r)r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(e.mutations[r].updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r);var i=e.mutations.map(function(e){return Ua(t.Lt,e)}),o=Gi.fromMillis(e.localWriteTimeMs);return new Lu(e.batchId,o,n,i)}function Hu(t){var e,n,r=Gu(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Gu(t.lastLimboFreeSnapshotVersion):zi.min();return void 0!==t.query.documents?(Mi(1===(n=t.query).documents.length),e=ss(Zo(Ca(n.documents[0])))):e=function(t){return ss(Ba(t))}(t.query),new Mu(e,t.targetId,0,t.lastListenSequenceNumber,r,i,eo.fromBase64String(t.resumeToken))}function Wu(t,e){var n,r=Ku(e.snapshotVersion),i=Ku(e.lastLimboFreeSnapshotVersion);n=Ro(e.target)?Fa(t.Lt,e.target):qa(t.Lt,e.target);var o=e.resumeToken.toBase64();return new du(e.targetId,Co(e.target),r,o,e.sequenceNumber,i,n)}function $u(t){var e=Ba({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?as(e,e.limit,"L"):e}var Xu=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Yu(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:Gu(e.createTime),version:e.version};var e})},t.prototype.saveBundleMetadata=function(t,e){return Yu(t).put({bundleId:(n=e).id,createTime:Ku(Aa(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Ju(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:$u(e.bundledQuery),readTime:Gu(e.readTime)};var e})},t.prototype.saveNamedQuery=function(t,e){return Ju(t).put(function(t){return{name:t.name,readTime:Ku(Aa(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Yu(t){return Ru(t,vu.store)}function Ju(t){return Ru(t,bu.store)}var Zu=function(){function t(){this.Bt=new tc}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Ou.resolve()},t.prototype.getCollectionParents=function(t,e){return Ou.resolve(this.Bt.getEntries(e))},t}(),tc=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new ta(Yi.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new ta(Yi.comparator)).toArray()},t}(),ec=function(){function t(){this.qt=new tc}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});var o={collectionId:r,parent:tu(i)};return nc(t).put(o)}return Ou.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Ki(e),""],!1,!0);return nc(t).Nt(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ru(o.parent))}return n})},t}();function nc(t){return Ru(t,yu.store)}var rc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ic=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function oc(t,e,n){var r=t.store(au.store),i=t.store(uu.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){Mi(1===a)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=uu.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Ou.waitFor(o).next(function(){return c})}function sc(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Vi();e=t.noDocument}return JSON.stringify(e).length}ic.DEFAULT_COLLECTION_PERCENTILE=10,ic.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ic.DEFAULT=new ic(41943040,ic.DEFAULT_COLLECTION_PERCENTILE,ic.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ic.DISABLED=new ic(-1,0,0);var ac=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Mi(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return cc(t).$t({index:au.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=hc(t),s=cc(t);return s.add({}).next(function(a){Mi("number"==typeof a);for(var u=new Lu(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Ma(t.Lt,e)}),i=n.mutations.map(function(e){return Ma(t.Lt,e)});return new au(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new ta(function(t,e){return Bi(t.canonicalString(),e.canonicalString())}),f=0,d=r;f<d.length;f++){var p=d[f],g=uu.key(i.userId,p.key.path,a);l=l.add(p.key.path.popLast()),h.push(s.put(c)),h.push(o.put(g,uu.PLACEHOLDER))}return l.forEach(function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))}),t.addOnCommittedListener(function(){i.Kt[a]=u.keys()}),Ou.waitFor(h).next(function(){return u})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return cc(t).get(e).next(function(t){return t?(Mi(t.userId===n.userId),zu(n.R,t)):null})},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Ou.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return cc(t).$t({index:au.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Mi(e.batchId>=r),o=zu(n.R,e)),i.done()}).next(function(){return o})},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return cc(t).$t({index:au.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return cc(t).Nt(au.userMutationsIndex,n).next(function(t){return t.map(function(t){return zu(e.R,t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=uu.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return hc(t).$t({range:i},function(r,i,s){var a=r[0],u=r[2],c=ru(r[1]);if(a===n.userId&&e.path.isEqual(c))return cc(t).get(u).next(function(t){if(!t)throw Vi();Mi(t.userId===n.userId),o.push(zu(n.R,t))});s.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ta(Bi),i=[];return e.forEach(function(e){var o=uu.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=hc(t).$t({range:s},function(t,i,o){var s=t[0],a=t[2],u=ru(t[1]);s===n.userId&&e.path.isEqual(u)?r=r.add(a):o.done()});i.push(a)}),Ou.waitFor(i).next(function(){return n.Wt(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=uu.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new ta(Bi);return hc(t).$t({range:s},function(t,e,o){var s=t[0],u=t[2],c=ru(t[1]);s===n.userId&&r.isPrefixOf(c)?c.length===i&&(a=a.add(u)):o.done()}).next(function(){return n.Wt(t,a)})},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(cc(t).get(e).next(function(t){if(null===t)throw Vi();Mi(t.userId===n.userId),r.push(zu(n.R,t))}))}),Ou.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return oc(t.Mt,this.userId,e).next(function(r){return t.addOnCommittedListener(function(){n.Gt(e.batchId)}),Ou.forEach(r,function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)})})},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Ou.resolve();var r=IDBKeyRange.lowerBound(uu.prefixForUser(e.userId)),i=[];return hc(t).$t({range:r},function(t,n,r){if(t[0]===e.userId){var o=ru(t[1]);i.push(o)}else r.done()}).next(function(){Mi(0===i.length)})})},t.prototype.containsKey=function(t,e){return uc(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return lc(t).get(this.userId).next(function(t){return t||new su(e.userId,-1,"")})},t}();function uc(t,e,n){var r=uu.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return hc(t).$t({range:o,kt:!0},function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()}).next(function(){return s})}function cc(t){return Ru(t,au.store)}function hc(t){return Ru(t,uu.store)}function lc(t){return Ru(t,su.store)}var fc=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),dc=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next(function(n){var r=new fc(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return zi.fromTimestamp(new Gi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)})},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next(function(){return n.Xt(t).next(function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)})})},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return pc(t).delete(e.targetId)}).next(function(){return n.Xt(t)}).next(function(e){return Mi(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return pc(t).$t(function(s,a){var u=Hu(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))}).next(function(){return Ou.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){return pc(t).$t(function(t,n){var r=Hu(n);e(r)})},t.prototype.Xt=function(t){return gc(t).get(gu.key).next(function(t){return Mi(null!==t),t})},t.prototype.Zt=function(t,e){return gc(t).put(gu.key,e)},t.prototype.te=function(t,e){return pc(t).put(Wu(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},t.prototype.getTargetData=function(t,e){var n=Co(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return pc(t).$t({range:r,index:du.queryTargetsIndexName},function(t,n,r){var o=Hu(n);Po(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=yc(t);return e.forEach(function(e){var s=tu(e.path);i.push(o.put(new pu(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))}),Ou.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=yc(t);return Ou.forEach(e,function(e){var o=tu(e.path);return Ou.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=yc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=yc(t),i=ca();return r.$t({range:n,kt:!0},function(t,e,n){var r=ru(t[1]),o=new fo(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n=tu(e.path),r=IDBKeyRange.bound([n],[Ki(n)],!1,!0),i=0;return yc(t).$t({index:pu.documentTargetsIndex,kt:!0,range:r},function(t,e,n){0!==t[0]&&(i++,n.done())}).next(function(){return i>0})},t.prototype.lt=function(t,e){return pc(t).get(e).next(function(t){return t?Hu(t):null})},t}();function pc(t){return Ru(t,du.store)}function gc(t){return Ru(t,gu.store)}function yc(t){return Ru(t,pu.store)}function mc(t){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(e){if(t.code!==Di.FAILED_PRECONDITION||t.message!==Eu)throw t;return Ci("LocalStore","Unexpectedly lost primary lease"),[2]})})}function vc(t,e){var n=t[1],r=e[1],i=Bi(t[0],e[0]);return 0===i?Bi(n,r):i}var bc=function(){function t(t){this.ne=t,this.buffer=new ta(vc),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();vc(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),wc=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Ci("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return Object(mt.b)(e,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Du(e=n.sent())?(Ci("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,mc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}})})})},t}(),Ec=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Ou.resolve(ki.o);var r=new bc(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Ci("LruGarbageCollector","Garbage collection skipped; disabled"),Ou.resolve(rc)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(Ci("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),rc):n.fe(t,e)})},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>c.params.maximumSequenceNumbersToCollect?(Ci("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)}).next(function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)}).next(function(t){return u=Date.now(),ji()<=bt.a.DEBUG&&Ci("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Ou.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),Ic=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Ec(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.de=function(t){var e=0;return this.le(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,function(t,n){return e(n)})},t.prototype.addReference=function(t,e,n){return Tc(t,n)},t.prototype.removeReference=function(t,e,n){return Tc(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Tc(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return lc(t).Ot(function(r){return uc(t,r,e).next(function(t){return t&&(n=!0),Ou.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,function(s,a){if(a<=e){var u=n._e(t,s).next(function(e){if(!e)return o++,r.getEntry(t,s).next(function(){return r.removeEntry(s),yc(t).delete([0,tu(s.path)])})});i.push(u)}}).next(function(){return Ou.waitFor(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Tc(t,e)},t.prototype.we=function(t,e){var n,r=yc(t),i=ki.o;return r.$t({index:pu.documentTargetsIndex},function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==ki.o&&e(new fo(ru(n)),i),i=s,n=o):i=ki.o}).next(function(){i!==ki.o&&e(new fo(ru(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Tc(t,e){return yc(t).put(function(t,e){return new pu(0,tu(t.path),e)}(e,t.currentSequenceNumber))}var Oc=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.equalsFn(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Wi(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}})},t.prototype.isEmpty=function(){return $i(this.inner)},t}(),_c=function(){function t(){this.changes=new Oc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:zi.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:xo.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Ou.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Sc=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Dc(t).put(xc(e),n)},t.prototype.removeEntry=function(t,e){var n=Dc(t),r=xc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.me(t,r)})},t.prototype.getEntry=function(t,e){var n=this;return Dc(t).get(xc(e)).next(function(t){return n.ye(e,t)})},t.prototype.ge=function(t,e){var n=this;return Dc(t).get(xc(e)).next(function(t){return{document:n.ye(e,t),size:sc(t)}})},t.prototype.getEntries=function(t,e){var n=this,r=ra();return this.pe(t,e,function(t,e){var i=n.ye(t,e);r=r.insert(t,i)}).next(function(){return r})},t.prototype.Ee=function(t,e){var n=this,r=ra(),i=new Ys(fo.comparator);return this.pe(t,e,function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,sc(e))}).next(function(){return{documents:r,Te:i}})},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Ou.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Dc(t).$t({range:r},function(t,e,r){for(var s=fo.fromSegments(t);o&&fo.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=ra(),o=e.path.length+1,s={};if(n.isEqual(zi.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=Bu(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=lu.collectionReadTimeIndex}return Dc(t).$t(s,function(t,n,s){if(t.length===o){var a=Fu(r.R,n);e.path.isPrefixOf(a.key.path)?ls(e,a)&&(i=i.insert(a.key,a)):s.done()}}).next(function(){return i})},t.prototype.newChangeBuffer=function(t){return new Ac(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return kc(t).get(fu.key).next(function(t){return Mi(!!t),t})},t.prototype.me=function(t,e){return kc(t).put(fu.key,e)},t.prototype.ye=function(t,e){if(e){var n=Fu(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(zi.min()))return n}return xo.newInvalidDocument(t)},t}(),Ac=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Oc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return Object(mt.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new ta(function(t,e){return Bi(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=qu(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=sc(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=qu(e.Ie.R,xo.newNoDocument(o,zi.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))}),i.forEach(function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))}),n.push(this.Ie.updateMetadata(t,r)),Ou.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},e}(_c);function kc(t){return Ru(t,fu.store)}function Dc(t){return Ru(t,lu.store)}function xc(t){return t.path.toArray()}var Nc=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Mi(n<r&&n>=0&&r<=11);var o=new _u("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(ou.store)}(t),function(t){t.createObjectStore(su.store,{keyPath:su.keyPath}),t.createObjectStore(au.store,{keyPath:au.keyPath,autoIncrement:!0}).createIndex(au.userMutationsIndex,au.userMutationsKeyPath,{unique:!0}),t.createObjectStore(uu.store)}(t),jc(t),function(t){t.createObjectStore(lu.store)}(t));var s=Ou.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(pu.store),t.deleteObjectStore(du.store),t.deleteObjectStore(gu.store)}(t),jc(t)),s=s.next(function(){return function(t){var e=t.store(gu.store),n=new gu(0,0,zi.min().toTimestamp(),0);return e.put(gu.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(au.store).Nt().next(function(n){t.deleteObjectStore(au.store),t.createObjectStore(au.store,{keyPath:au.keyPath,autoIncrement:!0}).createIndex(au.userMutationsIndex,au.userMutationsKeyPath,{unique:!0});var r=e.store(au.store),i=n.map(function(t){return r.put(t)});return Ou.waitFor(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(mu.store,{keyPath:mu.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.Re(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(fu.store)}(t),i.be(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ve(o)})),n<8&&r>=8&&(s=s.next(function(){return i.Pe(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(lu.store);e.createIndex(lu.readTimeIndex,lu.readTimeIndexPath,{unique:!1}),e.createIndex(lu.collectionReadTimeIndex,lu.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.Ve(o)})),n<11&&r>=11&&(s=s.next(function(){!function(t){t.createObjectStore(vu.store,{keyPath:vu.keyPath})}(t),function(t){t.createObjectStore(bu.store,{keyPath:bu.keyPath})}(t)})),s},t.prototype.be=function(t){var e=0;return t.store(lu.store).$t(function(t,n){e+=sc(n)}).next(function(){var n=new fu(e);return t.store(fu.store).put(fu.key,n)})},t.prototype.Re=function(t){var e=this,n=t.store(su.store),r=t.store(au.store);return n.Nt().next(function(n){return Ou.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(au.userMutationsIndex,i).next(function(r){return Ou.forEach(r,function(r){Mi(r.userId===n.userId);var i=zu(e.R,r);return oc(t,n.userId,i).next(function(){})})})})})},t.prototype.ve=function(t){var e=t.store(pu.store),n=t.store(lu.store);return t.store(gu.store).get(gu.key).next(function(t){var r=[];return n.$t(function(n,i){var o=new Yi(n),s=function(t){return[0,tu(t)]}(o);r.push(e.get(s).next(function(n){return n?Ou.resolve():function(n){return e.put(new pu(0,tu(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return Ou.waitFor(r)})})},t.prototype.Pe=function(t,e){t.createObjectStore(yu.store,{keyPath:yu.keyPath});var n=e.store(yu.store),r=new tc,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:tu(i)})}};return e.store(lu.store).$t({kt:!0},function(t,e){var n=new Yi(t);return i(n.popLast())}).next(function(){return e.store(uu.store).$t({kt:!0},function(t,e){var n=ru(t[1]);return i(n.popLast())})})},t.prototype.Ve=function(t){var e=this,n=t.store(du.store);return n.$t(function(t,r){var i=Hu(r),o=Wu(e.R,i);return n.put(o)})},t}();function jc(t){t.createObjectStore(pu.store,{keyPath:pu.keyPath}).createIndex(pu.documentTargetsIndex,pu.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(du.store,{keyPath:du.keyPath}).createIndex(du.queryTargetsIndexName,du.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(gu.store)}var Cc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Pc=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new xi(Di.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ic(this,i),this.Le=n+"main",this.R=new Uu(u),this.Be=new Su(this.Le,11,new Nc(this.R)),this.qe=new dc(this.referenceDelegate,this.R),this.Ut=new ec,this.Ue=function(t,e){return new Sc(t,e)}(this.R,this.Ut),this.Ke=new Xu,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&Pi("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new xi(Di.FAILED_PRECONDITION,Cc);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.qe.getHighestSequenceNumber(e)})}).then(function(e){t.Ne=new ki(e,t.De)}).then(function(){t.xe=!0}).catch(function(e){return t.Be&&t.Be.close(),Promise.reject(e)})},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Object(mt.b)(e,void 0,void 0,function(){return Object(mt.d)(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt(function(n){return Object(mt.b)(e,void 0,void 0,function(){return Object(mt.d)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return Object(mt.b)(e,void 0,void 0,function(){return Object(mt.d)(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Lc(e).put(new mu(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Je(e).next(function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable(function(){return t.Me(!1)}))})}).next(function(){return t.Ye(e)}).next(function(n){return t.isPrimary&&!n?t.Xe(e).next(function(){return!1}):!!n&&t.Ze(e).next(function(){return!0})})}).catch(function(e){if(Du(e))return Ci("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Ci("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Se.enqueueRetryable(function(){return t.Me(e)}),t.isPrimary=e})},t.prototype.Je=function(t){var e=this;return Rc(t).get(ou.key).next(function(t){return Ou.resolve(e.tn(t))})},t.prototype.en=function(t){return Lc(t).delete(this.clientId)},t.prototype.nn=function(){return Object(mt.b)(this,void 0,void 0,function(){var t,e,n,r=this;return Object(mt.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Ru(t,mu.store);return e.Nt().next(function(t){var n=r.rn(t,18e5),i=t.filter(function(t){return-1===n.indexOf(t)});return Ou.forEach(i,function(t){return e.delete(t.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)this.Qe.removeItem(this.on(n[e].clientId));i.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Ou.resolve(!0):Rc(t).get(ou.key).next(function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new xi(Di.FAILED_PRECONDITION,Cc);return!1}}return!(!e.networkEnabled||!e.inForeground)||Lc(t).Nt().next(function(t){return void 0===e.rn(t,5e3).find(function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))})})}).next(function(t){return e.isPrimary!==t&&Ci("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(){return Object(mt.b)(this,void 0,void 0,function(){var t=this;return Object(mt.d)(this,function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[ou.store,mu.store],function(e){var n=new Pu(e,ki.o);return t.Xe(n).next(function(){return t.en(n)})})];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Lc(e).Nt().next(function(e){return t.rn(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return ac.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r,i=this;return Ci("IndexedDbPersistence","Starting transaction:",t),this.Be.runTransaction(t,"readonly"===e?"readonly":"readwrite",wu,function(o){return r=new Pu(o,i.Ne?i.Ne.next():ki.o),"readwrite-primary"===e?i.Je(r).next(function(t){return!!t||i.Ye(r)}).next(function(e){if(!e)throw Pi("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new xi(Di.FAILED_PRECONDITION,Eu);return n(r)}).next(function(t){return i.Ze(r).next(function(){return t})}):i.dn(r).next(function(){return n(r)})}).then(function(t){return r.raiseOnCommittedEvent(),t})},t.prototype.dn=function(t){var e=this;return Rc(t).get(ou.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new xi(Di.FAILED_PRECONDITION,Cc)})},t.prototype.Ze=function(t){var e=new ou(this.clientId,this.allowTabSynchronization,Date.now());return Rc(t).put(ou.key,e)},t.yt=function(){return Su.yt()},t.prototype.Xe=function(t){var e=this,n=Rc(t);return n.get(ou.key).next(function(t){return e.tn(t)?(Ci("IndexedDbPersistence","Releasing primary lease."),n.delete(ou.key)):Ou.resolve()})},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Pi("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.je()})},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Ci("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Pi("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Pi("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Rc(t){return Ru(t,ou.store)}function Lc(t){return Ru(t,mu.store)}function Vc(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Mc=function(t,e){this.progress=t,this.wn=e},Uc=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.yn(t,e,r)})},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t})},t.prototype.gn=function(t,e){t.forEach(function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)})},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next(function(e){return n.En(t,e).next(function(){return e})})},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return fo.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):is(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new fo(e)).next(function(t){var e=oa();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=oa();return this.Ut.getCollectionParents(t,i).next(function(s){return Ou.forEach(s,function(s){var a=function(t,e){return new Yo(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next(function(t){t.forEach(function(t,e){o=o.insert(t,e)})})}).next(function(){return o})})},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){return o.Rn(t,i=e,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=xo.newInvalidDocument(c),r=r.insert(c,h)),Rs(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}})}).next(function(){return r.forEach(function(t,n){ls(e,n)||(r=r.remove(t))}),r})},t.prototype.Rn=function(t,e,n){for(var r=ca(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Fs&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},t}(),Fc=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=ca(),i=ca(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),qc=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(zi.min())?this.Dn(t,e):this.Sn.pn(t,r).next(function(o){var s=i.Cn(e,o);return(ts(e)||es(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(ji()<=bt.a.DEBUG&&Ci("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),hs(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next(function(t){return s.forEach(function(e){t=t.insert(e.key,e)}),t}))})},t.prototype.Cn=function(t,e){var n=new ta(fs(t));return e.forEach(function(e,r){ls(t,r)&&(n=n.add(r))}),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return ji()<=bt.a.DEBUG&&Ci("QueryEngine","Using full collection scan to execute query:",hs(e)),this.Sn.getDocumentsMatchingQuery(t,e,zi.min())},t}(),Bc=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new Ys(Bi),this.kn=new Oc(function(t){return Co(t)},Po),this.$n=zi.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Uc(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.Fn)})},t}();function Qc(t,e,n,r){return new Bc(t,e,n,r)}function Kc(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(mt.d)(this,function(s){switch(s.label){case 0:return n=Ui(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n._n.getAllMutationBatches(t).next(function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Uc(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)}).next(function(e){for(var n=[],r=[],s=ca(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++)s=s.add(l[h].key)}for(var f=0,d=e;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var g=0,y=p.mutations;g<y.length;g++)s=s.add(y[g].key)}return i.pn(t,s).next(function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function Gc(t,e){var n=Ui(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Ou.resolve();return o.forEach(function(t){s=s.next(function(){return r.getEntry(e,t)}).next(function(e){var o=n.docVersions.get(t);Mi(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))})}),s.next(function(){return t._n.removeMutationBatch(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}function zc(t){var e=Ui(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function Hc(t,e){var n=Ui(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach(function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)}));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Mi(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}});var a=ra();if(e.documentUpdates.forEach(function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),s.push(Wc(t,o,e.documentUpdates,r,void 0).next(function(t){a=t})),!r.isEqual(zi.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next(function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)});s.push(u)}return Ou.waitFor(s).next(function(){return o.apply(t)}).next(function(){return n.Mn.En(t,a)}).next(function(){return a})}).then(function(t){return n.Fn=i,t})}function Wc(t,e,n,r,i){var o=ca();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=ra();return n.forEach(function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(zi.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Ci("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),o})}function $c(t,e){var n=Ui(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)})}function Xc(t,e){var n=Ui(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.qe.getTargetData(t,e).next(function(i){return i?Ou.resolve(r=i):n.qe.allocateTargetId(t).next(function(i){return r=new Mu(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next(function(){return r})})})}).then(function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t})}function Yc(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(mt.d)(this,function(a){switch(a.label){case 0:r=Ui(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.referenceDelegate.removeTarget(t,i)})];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Du(s=a.sent()))throw s;return Ci("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}})})}function Jc(t,e,n){var r=Ui(t),i=zi.min(),o=ca();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Ui(t),i=r.kn.get(n);return void 0!==i?Ou.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,ss(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next(function(t){o=t})}).next(function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:zi.min(),n?o:ca())}).next(function(t){return{documents:t,Bn:o}})})}function Zc(t,e){var n=Ui(t),r=Ui(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.lt(t,e).next(function(t){return t?t.target:null})})}function th(t){var e=Ui(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=Ui(t),i=ra(),o=Bu(n),s=Dc(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:lu.readTimeIndex,range:a},function(t,e){var n=Fu(r.R,e);i=i.insert(n.key,n),o=e.readTime}).next(function(){return{wn:i,readTime:Qu(o)}})}(e.On,t,e.$n)}).then(function(t){var n=t.wn;return e.$n=t.readTime,n})}function eh(t){return Object(mt.b)(this,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){return[2,(e=Ui(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Dc(t),n=zi.min();return e.$t({index:lu.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=Qu(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.$n=t})]})})}function nh(t,e,n,r){return Object(mt.b)(this,void 0,void 0,function(){var i,o,s,a,u,c,h,l,f,d;return Object(mt.d)(this,function(p){switch(p.label){case 0:for(i=Ui(t),o=ca(),s=ra(),a=aa(),u=0,c=n;u<c.length;u++)l=e.qn((h=c[u]).metadata.name),h.document&&(o=o.add(l)),s=s.insert(l,e.Un(h)),a=a.insert(l,e.Kn(h.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,Xc(i,function(t){return ss(Zo(Yi.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return Wc(t,f,s,zi.min(),a).next(function(e){return f.apply(t),e}).next(function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next(function(){return i.qe.addMatchingKeys(t,o,d.targetId)}).next(function(){return i.Mn.En(t,e)}).next(function(){return e})})})]}})})}function rh(t,e,n){return void 0===n&&(n=ca()),Object(mt.b)(this,void 0,void 0,function(){var r,i;return Object(mt.d)(this,function(o){switch(o.label){case 0:return[4,Xc(t,ss($u(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Ui(t)).persistence.runTransaction("Save named query","readwrite",function(t){var o=Aa(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(t,e);var s=r.withResumeToken(eo.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(s.targetId,s),i.qe.updateTargetData(t,s).next(function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)}).next(function(){return i.qe.addMatchingKeys(t,n,r.targetId)}).next(function(){return i.Ke.saveNamedQuery(t,e)})})]}})})}var ih=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Ou.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:Aa(n.createTime)}),Ou.resolve()},t.prototype.getNamedQuery=function(t,e){return Ou.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:$u(t.bundledQuery),readTime:Aa(t.readTime)}}(e)),Ou.resolve()},t}(),oh=function(){function t(){this.Wn=new ta(sh.Gn),this.zn=new ta(sh.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new sh(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.Yn(new sh(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.Zn=function(t){var e=this,n=new fo(new Yi([])),r=new sh(n,t),i=new sh(n,t+1),o=[];return this.zn.forEachInRange([r,i],function(t){e.Yn(t),o.push(t.key)}),o},t.prototype.ts=function(){var t=this;this.Wn.forEach(function(e){return t.Yn(e)})},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new fo(new Yi([])),n=new sh(e,t),r=new sh(e,t+1),i=ca();return this.zn.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new sh(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),sh=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return fo.comparator(t.key,e.key)||Bi(t.ns,e.ns)},t.Hn=function(t,e){return Bi(t.ns,e.ns)||fo.comparator(t.key,e.key)},t}(),ah=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new ta(sh.Gn)}return t.prototype.checkEmpty=function(t){return Ou.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++;var o=new Lu(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new sh(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Ou.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Ou.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this.cs(e+1),r=n<0?0:n;return Ou.resolve(this._n.length>r?this._n[r]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Ou.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Ou.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new sh(e,0),i=new sh(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(t){var e=n.os(t.ns);o.push(e)}),Ou.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ta(Bi);return e.forEach(function(t){var e=new sh(t,0),i=new sh(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],function(t){r=r.add(t.ns)})}),Ou.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;fo.isDocumentKey(i)||(i=i.child(""));var o=new sh(new fo(i),0),s=new ta(Bi);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)},o),Ou.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.os(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Mi(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Ou.forEach(e.mutations,function(i){var o=new sh(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(function(){n.rs=r})},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new sh(e,0),r=this.rs.firstAfterOrEqual(n);return Ou.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return Ou.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),uh=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Ys(fo.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Ou.resolve(n?n.document.clone():xo.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=ra();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():xo.newInvalidDocument(t))}),Ou.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=ra(),i=new fo(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.value,u=a.document,c=a.readTime;if(!e.path.isPrefixOf(s.key.path))break;c.compareTo(n)<=0||ls(e,u)&&(r=r.insert(u.key,u.clone()))}return Ou.resolve(r)},t.prototype.fs=function(t,e){return Ou.forEach(this.docs,function(t){return e(t)})},t.prototype.newChangeBuffer=function(t){return new ch(this)},t.prototype.getSize=function(t){return Ou.resolve(this.size)},t}(),ch=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Object(mt.c)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)}),Ou.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(_c),hh=function(){function t(t){this.persistence=t,this.ds=new Oc(function(t){return Co(t)},Po),this.lastRemoteSnapshotVersion=zi.min(),this.highestTargetId=0,this.ws=0,this._s=new oh,this.targetCount=0,this.ys=fc.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach(function(t,n){return e(n)}),Ou.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Ou.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Ou.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Ou.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Ou.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new fc(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Ou.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Ou.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Ou.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach(function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)}),Ou.waitFor(o).next(function(){return i})},t.prototype.getTargetCount=function(t){return Ou.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Ou.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Ou.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.markPotentiallyOrphaned(t,e))}),Ou.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Ou.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Ou.resolve(n)},t.prototype.containsKey=function(t,e){return Ou.resolve(this._s.containsKey(e))},t}(),lh=function(){function t(t,e){var n=this;this.gs={},this.Ne=new ki(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new hh(this),this.Ut=new Zu,this.Ue=function(t,e){return new uh(t,function(t){return n.referenceDelegate.ps(t)})}(this.Ut),this.R=new Uu(e),this.Ke=new ih(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new ah(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Ci("MemoryPersistence","Starting transaction:",t);var i=new fh(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},t.prototype.Is=function(t,e){return Ou.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(t,e)}}))},t}(),fh=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Object(mt.c)(e,t),e}(Iu),dh=function(){function t(t){this.persistence=t,this.As=new oh,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Vi()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Ou.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Ou.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Ou.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ou.forEach(this.vs,function(r){var i=fo.fromPath(r);return e.Ps(t,i).next(function(t){t||n.removeEntry(i)})}).next(function(){return e.Rs=null,n.apply(t)})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Ou.or([function(){return Ou.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),ph=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function gh(t,e){return"firestore_clients_"+t+"_"+e}function yh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function mh(t,e){return"firestore_targets_"+t+"_"+e}ph.UNAUTHENTICATED=new ph(null),ph.GOOGLE_CREDENTIALS=new ph("google-credentials-uid"),ph.FIRST_PARTY=new ph("first-party-uid");var vh=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new xi(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Pi("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),bh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new xi(i.error.code,i.error.message)),o?new t(e,i.state,r):(Pi("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),wh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=la(),s=0;i&&s<r.activeTargetIds.length;++s)i=lo(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Pi("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Eh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Pi("SharedClientState","Failed to parse online state: "+e),null)},t}(),Ih=function(){function t(){this.activeTargetIds=la()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Th=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new Ys(Bi),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=gh(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Ih),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Object(mt.b)(this,void 0,void 0,function(){var t,e,n,r,i,o,s,a,u,c,h=this;return Object(mt.d)(this,function(l){switch(l.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(gh(this.persistenceKey,r)))&&(o=wh.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)this.Fs(c[u]);return this.$s=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(mh(this.persistenceKey,t));if(n){var r=bh.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(mh(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ci("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Ci("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Ci("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Ci("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Pi("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return Object(mt.b)(e,void 0,void 0,function(){var t,e,r,i,o,s;return Object(mt.d)(this,function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=ki.o;if(null!=t)try{var n=JSON.parse(t);Mi("number"==typeof n),e=n}catch(t){Pi("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==ki.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new vh(this.currentUser,t,e,n),i=yh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=yh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:t}))},t.prototype.Ys=function(t,e,n){var r=mh(this.persistenceKey,t),i=new bh(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return wh.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]);return vh.Vs(new ph(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return bh.Vs(r,e)},t.prototype.js=function(t){return Eh.Vs(t)},t.prototype.ii=function(t){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Ci("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.ks=r})},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=la();return t.forEach(function(t,n){e=e.unionWith(n.activeTargetIds)}),e},t}(),Oh=function(){function t(){this.li=new Ih,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Ih,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),_h=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Sh=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Ci("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Ci("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Ah={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},kh=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Dh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Object(mt.c)(e,t),e.prototype.ki=function(t,e,n,r){return new Promise(function(i,o){var s=new Ai;s.listenOnce(Ti.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Ii.NO_ERROR:var e=s.getResponseJson();Ci("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Ii.TIMEOUT:Ci("Connection",'RPC "'+t+'" timed out'),o(new xi(Di.DEADLINE_EXCEEDED,"Request time out"));break;case Ii.HTTP_ERROR:var n=s.getStatus();if(Ci("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Di).indexOf(e)>=0?e:Di.UNKNOWN}(r.status);o(new xi(a,r.message))}else o(new xi(Di.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new xi(Di.UNAVAILABLE,"Connection failed."));break;default:Vi()}}finally{Ci("Connection",'RPC "'+t+'" completed.')}});var a=JSON.stringify(r);s.send(e,"POST",a,n,15)})},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new mi,i=ln(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new _i({})),this.Fi(o.initMessageHeaders,e),Object(vt.n)()||Object(vt.p)()||Object(vt.l)()||Object(vt.m)()||Object(vt.q)()||Object(vt.k)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Ci("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new kh({Ei:function(t){c?Ci("Connection","Not sending because WebChannel is closed:",t):(u||(Ci("Connection","Opening WebChannel transport."),a.open(),u=!0),Ci("Connection","WebChannel sending:",t),a.send(t))},Ti:function(){return a.close()}}),l=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return l(a,Si.EventType.OPEN,function(){c||Ci("Connection","WebChannel transport opened.")}),l(a,Si.EventType.CLOSE,function(){c||(c=!0,Ci("Connection","WebChannel transport closed"),h.Vi())}),l(a,Si.EventType.ERROR,function(t){c||(c=!0,Ri("Connection","WebChannel transport errored:",t),h.Vi(new xi(Di.UNAVAILABLE,"The operation could not be completed")))}),l(a,Si.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];Mi(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Ci("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=Ks[t];if(void 0!==e)return Xs(e)}(i),s=r.message;void 0===o&&(o=Di.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.Vi(new xi(o,s)),a.close()}else Ci("Connection","WebChannel received:",n),h.Si(n)}}),l(i,Oi.STAT_EVENT,function(t){10===t.stat?Ci("Connection","Detected buffering proxy"):11===t.stat&&Ci("Connection","Detected no buffering proxy")}),setTimeout(function(){h.Pi()},0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.Di=(t.ssl?"https":"http")+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Ci("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then(function(t){return Ci("RestConnection","Received: ",t),t},function(e){throw Ri("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.7.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){return this.Di+"/v1/"+e+":"+Ah[t]},t}());function xh(){return"undefined"!=typeof window?window:null}function Nh(){return"undefined"!=typeof document?document:null}function jh(t){return new Ta(t,!0)}var Ch=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Ci("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Ki=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Ph=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Ch(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Di.RESOURCE_EXHAUSTED?(Pi(e.toString()),Pi("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Di.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(e){t.Yi===n&&t.lr(e)},function(n){e(function(){var e=new xi(Di.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)})})},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return Object(mt.b)(t,void 0,void 0,function(){return Object(mt.d)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(t){return Ci("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget(function(){return e.Yi===t?n():(Ci("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Rh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Object(mt.c)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Vi()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Mi(void 0===e||"string"==typeof e),eo.fromBase64String(e||"")):(Mi(void 0===e||e instanceof Uint8Array),eo.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Di.UNKNOWN:Xs(t.code);return new xi(e,t.message||"")}(a);n=new ya(r,i,o,s||null)}else if("documentChange"in e){i=Na(t,(r=e.documentChange).document.name),o=Aa(r.document.updateTime);var a=new ko({mapValue:{fields:r.document.fields}}),u=(s=xo.newFoundDocument(i,o,a),r.targetIds||[]);n=new pa(u,r.removedTargetIds||[],s.key,s)}else if("documentDelete"in e)i=Na(t,(r=e.documentDelete).document),o=r.readTime?Aa(r.readTime):zi.min(),a=xo.newNoDocument(i,o),n=new pa([],s=r.removedTargetIds||[],a.key,a);else if("documentRemove"in e)i=Na(t,(r=e.documentRemove).document),n=new pa([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in e))return Vi();var c=e.filter;i=new Ws(r=c.count||0),n=new ga(o=c.targetId,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return zi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?zi.min():e.readTime?Aa(e.readTime):zi.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Pa(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Ro(r)?{documents:Fa(t,r)}:{query:qa(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=_a(t,e.resumeToken):e.snapshotVersion.compareTo(zi.min())>0&&(n.readTime=Oa(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Vi()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Pa(this.R),e.removeTarget=t,this.cr(e)},e}(Ph),Lh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Object(mt.c)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Mi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Mi(void 0!==e),t.map(function(t){return function(t,e){var n=Aa(t.updateTime?t.updateTime:e);return n.isEqual(zi.min())&&(n=Aa(e)),new xs(n,t.transformResults||[])}(t,e)})):[]}(t.writeResults,t.commitTime),n=Aa(t.commitTime);return this.listener.Tr(n,e)}return Mi(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Pa(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Ma(e.R,t)})};this.cr(n)},e}(Ph),Vh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(mt.c)(e,t),e.prototype.br=function(){if(this.Rr)throw new xi(Di.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Di.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new xi(Di.UNKNOWN,t.toString())})},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(t,e,n,i)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Di.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new xi(Di.UNKNOWN,t.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),Mh=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Pi(e),this.Vr=!1):Ci("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Uh=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return Object(mt.b)(o,void 0,void 0,function(){return Object(mt.d)(this,function(t){switch(t.label){case 0:return Wh(this)?(Ci("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Object(mt.b)(this,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){switch(n.label){case 0:return(e=Ui(t)).Or.add(4),[4,qh(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Fh(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new Mh(n,r)};function Fh(t){return Object(mt.b)(this,void 0,void 0,function(){var e,n;return Object(mt.d)(this,function(r){switch(r.label){case 0:if(!Wh(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function qh(t){return Object(mt.b)(this,void 0,void 0,function(){var e,n;return Object(mt.d)(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Bh(t,e){var n=Ui(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Hh(n)?zh(n):cl(n).er()&&Kh(n,e))}function Qh(t,e){var n=Ui(t),r=cl(n);n.$r.delete(e),r.er()&&Gh(n,e),0===n.$r.size&&(r.er()?r.ir():Wh(n)&&n.Br.set("Unknown"))}function Kh(t,e){t.qr.U(e.targetId),cl(t).mr(e)}function Gh(t,e){t.qr.U(e),cl(t).yr(e)}function zh(t){t.qr=new va({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),cl(t).start(),t.Br.Sr()}function Hh(t){return Wh(t)&&!cl(t).tr()&&t.$r.size>0}function Wh(t){return 0===Ui(t).Or.size}function $h(t){t.qr=void 0}function Xh(t){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(e){return t.$r.forEach(function(e,n){Kh(t,e)}),[2]})})}function Yh(t,e){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(n){return $h(t),Hh(t)?(t.Br.Nr(e),zh(t)):t.Br.set("Unknown"),[2]})})}function Jh(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r,i,o;return Object(mt.d)(this,function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof ya&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(mt.d)(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?t.$r.has(o=i[r])?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Ci("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Zh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof pa?t.qr.X(e):e instanceof ga?t.qr.rt(e):t.qr.et(e),n.isEqual(zi.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,zc(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach(function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(eo.EMPTY_BYTE_STRING,n.snapshotVersion)),Gh(t,e);var r=new Mu(n.target,e,1,n.sequenceNumber);Kh(t,r)}}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Ci("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Zh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function Zh(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r=this;return Object(mt.d)(this,function(i){switch(i.label){case 0:if(!Du(e))throw e;return t.Or.add(1),[4,qh(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return zc(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return Object(mt.b)(r,void 0,void 0,function(){return Object(mt.d)(this,function(e){switch(e.label){case 0:return Ci("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Fh(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function tl(t,e){return e().catch(function(n){return Zh(t,n,e)})}function el(t){return Object(mt.b)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(mt.d)(this,function(s){switch(s.label){case 0:e=Ui(t),n=hl(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Wh(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,$c(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=hl(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Zh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return nl(e)&&rl(e),[2]}})})}function nl(t){return Wh(t)&&!hl(t).tr()&&t.kr.length>0}function rl(t){hl(t).start()}function il(t){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(e){return hl(t).Ar(),[2]})})}function ol(t){return Object(mt.b)(this,void 0,void 0,function(){var e,n,r;return Object(mt.d)(this,function(i){for(e=hl(t),n=0,r=t.kr;n<r.length;n++)e.Er(r[n].mutations);return[2]})})}function sl(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r,i;return Object(mt.d)(this,function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Vu.from(r,e,n),[4,tl(t,function(){return t.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,el(t)];case 2:return o.sent(),[2]}})})}function al(t,e){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(n){switch(n.label){case 0:return e&&hl(t).pr?[4,function(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r;return Object(mt.d)(this,function(i){switch(i.label){case 0:return $s(r=e.code)&&r!==Di.ABORTED?(n=t.kr.shift(),hl(t).sr(),[4,tl(t,function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,el(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return nl(t)&&rl(t),[2]}})})}function ul(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n;return Object(mt.d)(this,function(r){switch(r.label){case 0:return n=Ui(t),e?(n.Or.delete(2),[4,Fh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,qh(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function cl(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Ui(t);return r.br(),new Rh(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Xh.bind(null,t),Ri:Yh.bind(null,t),_r:Jh.bind(null,t)}),t.Mr.push(function(n){return Object(mt.b)(e,void 0,void 0,function(){return Object(mt.d)(this,function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Hh(t)?zh(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),$h(t),e.label=3;case 3:return[2]}})})})),t.Ur}function hl(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=Ui(t);return r.br(),new Lh(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:il.bind(null,t),Ri:al.bind(null,t),Ir:ol.bind(null,t),Tr:sl.bind(null,t)}),t.Mr.push(function(n){return Object(mt.b)(e,void 0,void 0,function(){return Object(mt.d)(this,function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,el(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&(Ci("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}})})})),t.Kr}var ll=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Tu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new xi(Di.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function fl(t,e){if(Pi("AsyncQueue",e+": "+t),Du(t))return new xi(Di.UNAVAILABLE,e+": "+t);throw t}var dl=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||fo.comparator(e.key,n.key)}:function(t,e){return fo.comparator(t.key,e.key)},this.keyedMap=oa(),this.sortedSet=new Ys(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),pl=function(){function t(){this.Qr=new Ys(fo.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Vi():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal(function(e,n){t.push(n)}),t},t}(),gl=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,dl.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&us(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),yl=function(){this.Wr=void 0,this.listeners=[]},ml=function(){this.queries=new Oc(function(t){return cs(t)},us),this.onlineState="Unknown",this.Gr=new Set};function vl(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(mt.d)(this,function(c){switch(c.label){case 0:if(n=Ui(t),i=!1,(o=n.queries.get(r=e.query))||(i=!0,o=new yl),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=fl(a,"Initialization of query '"+hs(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Il(n),[2]}})})}function bl(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(mt.d)(this,function(a){return n=Ui(t),i=!1,(o=n.queries.get(r=e.query))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function wl(t,e){for(var n=Ui(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=n.queries.get(s.query);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&Il(n)}function El(t,e,n){var r=Ui(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Il(t){t.Gr.forEach(function(t){t.next()})}var Tl=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new gl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=gl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Ol=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),_l=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Na(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Va(this.R,t.document,!1):xo.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return Aa(t)},t}();!function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new _l(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||ca()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return Object(mt.b)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(mt.d)(this,function(o){switch(o.label){case 0:return[4,nh(this.localStore,new _l(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,rh(this.localStore,i=r[n],e.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Mc(Object.assign({},this.progress),t))]}})})}}();var Sl=function(t){this.key=t},Al=function(t){this.key=t},kl=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=ca(),this.mutatedKeys=ca(),this.lo=fs(t),this.fo=new dl(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new pl,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=ts(this.query)&&i.size===this.query.limit?i.last():null,c=es(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(function(t,e){var h=i.get(t),l=ls(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(a=!0)),p&&(l?(s=s.add(l),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),ts(this.query)||es(this.query))for(;s.size>this.query.limit;){var h=ts(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vi()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)}),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new gl(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new pl,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=ca(),this.fo.forEach(function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))});var n=[];return e.forEach(function(e){t.ho.has(e)||n.push(new Al(e))}),this.ho.forEach(function(t){e.has(t)||n.push(new Sl(t))}),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=ca();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return gl.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Dl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},xl=function(t){this.key=t,this.bo=!1},Nl=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Oc(function(t){return cs(t)},us),this.Vo=new Map,this.So=new Set,this.Do=new Ys(fo.comparator),this.Co=new Map,this.No=new oh,this.xo={},this.Fo=new Map,this.ko=fc.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function jl(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(mt.d)(this,function(a){switch(a.label){case 0:return n=uf(t),(i=n.Po.get(e))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,Xc(n.localStore,ss(e))];case 2:return o=a.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,Cl(n,e,o.targetId,"current"===s)];case 3:r=a.sent(),n.isPrimaryClient&&Bh(n.remoteStore,o),a.label=4;case 4:return[2,r]}})})}function Cl(t,e,n,r){return Object(mt.b)(this,void 0,void 0,function(){var i,o,s,a,u,c;return Object(mt.d)(this,function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Object(mt.b)(this,void 0,void 0,function(){var i,o,s;return Object(mt.d)(this,function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,Jc(t.localStore,e.query,!1).then(function(t){return e.view._o(t.documents,i)})]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(zl(t,e.targetId,s.To),s.snapshot)]}})})}(t,e,n,r)},[4,Jc(t.localStore,e,!0)];case 1:return i=h.sent(),o=new kl(e,i.Bn),s=o._o(i.documents),a=da.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),zl(t,n,u.To),c=new Dl(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}})})}function Pl(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i;return Object(mt.d)(this,function(o){switch(o.label){case 0:return n=Ui(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(t){return!us(t,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Yc(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),Qh(n.remoteStore,r.targetId),Kl(n,r.targetId)}).catch(mc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Kl(n,r.targetId),[4,Yc(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function Rl(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(mt.d)(this,function(a){switch(a.label){case 0:r=cf(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Ui(t),i=Gi.now(),o=e.reduce(function(t,e){return t.add(e.key)},ca());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Mn.pn(t,o).next(function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=Ls(c,n.get(c.key));null!=h&&s.push(new Fs(c.key,h,Do(h.value.mapValue),Ns.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)})}).then(function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}})}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Ys(Bi)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,$l(r,i.changes)];case 3:return a.sent(),[4,el(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=fl(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Ll(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r;return Object(mt.d)(this,function(i){switch(i.label){case 0:n=Ui(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Hc(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach(function(t,e){var r=n.Co.get(e);r&&(Mi(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Mi(r.bo):t.removedDocuments.size>0&&(Mi(r.bo),r.bo=!1))}),[4,$l(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,mc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Vl(t,e,n){var r=Ui(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Ui(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)}),r&&Il(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Ml(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r,i,o,s,a,u;return Object(mt.d)(this,function(c){switch(c.label){case 0:return(r=Ui(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new Ys(fo.comparator)).insert(o,xo.newNoDocument(o,zi.min())),a=ca().add(o),u=new fa(zi.min(),new Map,new ta(Bi),s,a),[4,Ll(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Wl(r),[3,4];case 2:return[4,Yc(r.localStore,e,!1).then(function(){return Kl(r,e,n)}).catch(mc)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function Ul(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i;return Object(mt.d)(this,function(o){switch(o.label){case 0:n=Ui(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Gc(n.localStore,e)];case 2:return i=o.sent(),Ql(n,r,null),Bl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,$l(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,mc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function Fl(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r,i;return Object(mt.d)(this,function(o){switch(o.label){case 0:r=Ui(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Ui(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n._n.lookupMutationBatch(t,e).next(function(e){return Mi(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)}).next(function(){return n._n.performConsistencyCheck(t)}).next(function(){return n.Mn.pn(t,r)})})}(r.localStore,e)];case 2:return i=o.sent(),Ql(r,e,n),Bl(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,$l(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,mc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function ql(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i,o,s;return Object(mt.d)(this,function(a){switch(a.label){case 0:Wh((n=Ui(t)).remoteStore)||Ci("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Ui(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=fl(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}function Bl(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function Ql(t,e,n){var r=Ui(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Kl(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(e){t.No.containsKey(e)||Gl(t,e)})}function Gl(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Qh(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Wl(t))}function zl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Sl?(t.No.addReference(o.key,e),Hl(t,o)):o instanceof Al?(Ci("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Gl(t,o.key)):Vi()}}function Hl(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Ci("SyncEngine","New document in limbo: "+n),t.So.add(r),Wl(t))}function Wl(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new fo(Yi.fromString(e)),r=t.ko.next();t.Co.set(r,new xl(n)),t.Do=t.Do.insert(n,r),Bh(t.remoteStore,new Mu(ss(Zo(n.path)),r,2,ki.o))}}function $l(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r,i,o,s;return Object(mt.d)(this,function(a){switch(a.label){case 0:return r=Ui(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(t,a){s.push(r.Oo(a,e,n).then(function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Fc.Pn(a.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c;return Object(mt.d)(this,function(h){switch(h.label){case 0:n=Ui(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return Ou.forEach(e,function(e){return Ou.forEach(e.bn,function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)}).next(function(){return Ou.forEach(e.vn,function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)})})})})];case 2:return h.sent(),[3,4];case 3:if(!Du(r=h.sent()))throw r;return Ci("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=(s=o[i]).targetId,s.fromCache||(u=n.Fn.get(a),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),n.Fn=n.Fn.insert(a,c));return[2]}})})}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function Xl(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r;return Object(mt.d)(this,function(i){switch(i.label){case 0:return(n=Ui(t)).currentUser.isEqual(e)?[3,3]:(Ci("SyncEngine","User change. New user:",e.toKey()),[4,Kc(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach(function(t){t.forEach(function(t){t.reject(new xi(Di.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,$l(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function Yl(t,e){var n=Ui(t),r=n.Co.get(e);if(r&&r.bo)return ca().add(r.key);var i=ca(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=n.Po.get(a[s]);i=i.unionWith(u.view.wo)}return i}function Jl(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i;return Object(mt.d)(this,function(o){switch(o.label){case 0:return[4,Jc((n=Ui(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&zl(n,e.targetId,i.To),i)]}})})}function Zl(t){return Object(mt.b)(this,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){return[2,th((e=Ui(t)).localStore).then(function(t){return $l(e,t)})]})})}function tf(t,e,n,r){return Object(mt.b)(this,void 0,void 0,function(){var i,o;return Object(mt.d)(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Ui(t),r=Ui(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.jt(t,e).next(function(e){return e?n.Mn.pn(t,e):Ou.resolve(null)})})}((i=Ui(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,el(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Ql(i,e,r||null),Bl(i,e),function(t,e){Ui(Ui(t)._n).Gt(e)}(i.localStore,e)):Vi(),s.label=4;case 4:return[4,$l(i,o)];case 5:return s.sent(),[3,7];case 6:Ci("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}function ef(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u;return Object(mt.d)(this,function(c){switch(c.label){case 0:return uf(n=Ui(t)),cf(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,nf(n,r.toArray())]);case 1:return i=c.sent(),n.$o=!0,[4,ul(n.remoteStore,!0)];case 2:for(c.sent(),o=0,s=i;o<s.length;o++)Bh(n.remoteStore,s[o]);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(a=[],u=Promise.resolve(),n.Vo.forEach(function(t,e){n.sharedClientState.isLocalQueryTarget(e)?a.push(e):u=u.then(function(){return Kl(n,e),Yc(n.localStore,e,!0)}),Qh(n.remoteStore,e)}),[4,u]);case 4:return c.sent(),[4,nf(n,a)];case 5:return c.sent(),function(t){var e=Ui(t);e.Co.forEach(function(t,n){Qh(e.remoteStore,n)}),e.No.ts(),e.Co=new Map,e.Do=new Ys(fo.comparator)}(n),n.$o=!1,[4,ul(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function nf(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i,o,s,a,u,c,h,l,f,d,p;return Object(mt.d)(this,function(g){switch(g.label){case 0:n=Ui(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(u=void 0,(c=n.Vo.get(a=s[o]))&&0!==c.length?[4,Xc(n.localStore,ss(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=n.Po.get(l[h]),[4,Jl(n,f)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Zc(n.localStore,a)];case 8:return p=g.sent(),[4,Xc(n.localStore,p)];case 9:return u=g.sent(),[4,Cl(n,rf(p),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function rf(t){return Jo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function of(t){var e=Ui(t);return Ui(Ui(e.localStore).persistence).fn()}function sf(t,e,n,r){return Object(mt.b)(this,void 0,void 0,function(){var i,o,s;return Object(mt.d)(this,function(a){switch(a.label){case 0:return(i=Ui(t)).$o?(Ci("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,th(i.localStore)];case 3:return o=a.sent(),s=fa.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,$l(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,Yc(i.localStore,e,!0)];case 6:return a.sent(),Kl(i,e,r),[3,8];case 7:Vi(),a.label=8;case 8:return[2]}})})}function af(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r,i,o,s,a,u,c,h,l;return Object(mt.d)(this,function(f){switch(f.label){case 0:if(!(r=uf(t)).$o)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?r.Vo.has(s=o[i])?(Ci("SyncEngine","Adding an already active target "+s),[3,5]):[4,Zc(r.localStore,s)]:[3,6];case 2:return a=f.sent(),[4,Xc(r.localStore,a)];case 3:return u=f.sent(),[4,Cl(r,rf(a),u.targetId,!1)];case 4:f.sent(),Bh(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Object(mt.d)(this,function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Yc(r.localStore,t,!1).then(function(){Qh(r.remoteStore,t),Kl(r,t)}).catch(mc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},h=0,l=n,f.label=7;case 7:return h<l.length?[5,c(l[h])]:[3,10];case 8:f.sent(),f.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function uf(t){var e=Ui(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ll.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Yl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ml.bind(null,e),e.vo._r=wl.bind(null,e.eventManager),e.vo.Mo=El.bind(null,e.eventManager),e}function cf(t){var e=Ui(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ul.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Fl.bind(null,e),e}var hf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(e){switch(e.label){case 0:return this.R=jh(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}})})},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Qc(this.persistence,new qc,t.initialUser,this.R)},t.prototype.qo=function(t){return new lh(dh.bs,this.R)},t.prototype.Bo=function(t){return new Oh},t.prototype.terminate=function(){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},t}(),lf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(mt.c)(e,t),e.prototype.initialize=function(e){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,eh(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,cf(this.Qo.syncEngine)];case 4:return n.sent(),[4,el(this.Qo.remoteStore)];case 5:return n.sent(),[2]}})})},e.prototype.Ko=function(t){return Qc(this.persistence,new qc,t.initialUser,this.R)},e.prototype.Uo=function(t){return new wc(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue)},e.prototype.qo=function(t){var e=Vc(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ic.withCacheSize(this.cacheSizeBytes):ic.DEFAULT;return new Pc(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,xh(),Nh(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Oh},e}(hf),ff=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(mt.c)(e,t),e.prototype.initialize=function(e){return Object(mt.b)(this,void 0,void 0,function(){var n,r=this;return Object(mt.d)(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Th?(this.sharedClientState.syncEngine={ui:tf.bind(null,n),ai:sf.bind(null,n),hi:af.bind(null,n),fn:of.bind(null,n),ci:Zl.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(t){return Object(mt.b)(r,void 0,void 0,function(){return Object(mt.d)(this,function(e){switch(e.label){case 0:return[4,ef(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.Bo=function(t){var e=xh();if(!Th.yt(e))throw new xi(Di.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Vc(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Th(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(lf),df=function(){function t(){}return t.prototype.initialize=function(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n=this;return Object(mt.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Vl(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Xl.bind(null,this.syncEngine),[4,ul(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(t){return new ml},t.prototype.createDatastore=function(t){var e=jh(t.databaseInfo.databaseId),n=new Dh(t.databaseInfo);return function(t,e,n){return new Vh(t,e,n)}(t.credentials,n,e)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Vl(s.syncEngine,t,0)},o=Sh.yt()?new Sh:new _h,new Uh(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Nl(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Object(mt.b)(this,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){switch(n.label){case 0:return e=Ui(t),Ci("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,qh(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},t}(),pf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),gf=(function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Tu,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Lo=function(){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},t.prototype.Ho=function(){return Object(mt.b)(this,void 0,void 0,function(){var t,e,n,r;return Object(mt.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Ol(JSON.parse(r),t.length+n)]}})})},t.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.Jo=function(){return Object(mt.b)(this,void 0,void 0,function(){var t,e;return Object(mt.d)(this,function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.Xo=function(t){return Object(mt.b)(this,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return Object(mt.b)(this,void 0,void 0,function(){var t,e;return Object(mt.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Object(mt.b)(this,void 0,void 0,function(){var e,n=this;return Object(mt.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new xi(Di.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i,o,s,a;return Object(mt.d)(this,function(u){switch(u.label){case 0:return n=Ui(t),r=Pa(n.R)+"/documents",i={documents:e.map(function(t){return xa(n.R,t)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Mi(!!e.found);var n=Na(t,e.found.name),r=Aa(e.found.updateTime),i=new ko({mapValue:{fields:e.found.fields}});return xo.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Mi(!!e.missing),Mi(!!e.readTime);var n=Na(t,e.missing),r=Aa(e.readTime);return xo.newNoDocument(n,r)}(t,e):Vi()}(n.R,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Mi(!!e),a.push(e)}),a)]}})})}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new zs(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Object(mt.b)(this,void 0,void 0,function(){var t,e=this;return Object(mt.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=fo.fromPath(n);e.mutations.push(new Hs(r,e.precondition(r)))}),[4,function(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i;return Object(mt.d)(this,function(o){switch(o.label){case 0:return n=Ui(t),r=Pa(n.R)+"/documents",i={writes:e.map(function(t){return Ma(n.R,t)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Vi();e=zi.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new xi(Di.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Ns.updateTime(e):Ns.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(zi.min()))throw new xi(Di.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ns.updateTime(e)}return Ns.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),yf=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Ch(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji(function(){return Object(mt.b)(t,void 0,void 0,function(){var t,e,n=this;return Object(mt.d)(this,function(r){return t=new gf(this.datastore),(e=this.sc(t))&&e.then(function(e){n.asyncQueue.enqueueAndForget(function(){return t.commit().then(function(){n.deferred.resolve(e)}).catch(function(t){n.ic(t)})})}).catch(function(t){n.ic(t)}),[2]})})})},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!co(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!$s(e)}return!1},t}(),mf=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=ph.UNAUTHENTICATED,this.clientId=qi.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(t){return Object(mt.b)(r,void 0,void 0,function(){return Object(mt.d)(this,function(e){switch(e.label){case 0:return Ci("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}})})})}return t.prototype.getConfiguration=function(){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new xi(Di.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Tu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(mt.b)(t,void 0,void 0,function(){var t,n;return Object(mt.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=fl(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function vf(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(mt.d)(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Ci("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener(function(t){return Object(mt.b)(i,void 0,void 0,function(){return Object(mt.d)(this,function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Kc(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function bf(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r;return Object(mt.d)(this,function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,wf(t)];case 1:return n=i.sent(),Ci("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener(function(t){return function(t,e){return Object(mt.b)(this,void 0,void 0,function(){var n,r;return Object(mt.d)(this,function(i){switch(i.label){case 0:return(n=Ui(t)).asyncQueue.verifyOperationInProgress(),Ci("RemoteStore","RemoteStore received new credentials"),r=Wh(n),n.Or.add(3),[4,qh(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Fh(n)];case 3:return i.sent(),[2]}})})}(e.remoteStore,t)}),t.onlineComponents=e,[2]}})})}function wf(t){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Ci("FirestoreClient","Using default OfflineComponentProvider"),[4,vf(t,new hf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function Ef(t){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Ci("FirestoreClient","Using default OnlineComponentProvider"),[4,bf(t,new df)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function If(t){return wf(t).then(function(t){return t.persistence})}function Tf(t){return wf(t).then(function(t){return t.localStore})}function Of(t){return Ef(t).then(function(t){return t.remoteStore})}function _f(t){return Ef(t).then(function(t){return t.syncEngine})}function Sf(t){return Object(mt.b)(this,void 0,void 0,function(){var e,n;return Object(mt.d)(this,function(r){switch(r.label){case 0:return[4,Ef(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=jl.bind(null,e.syncEngine),n.onUnlisten=Pl.bind(null,e.syncEngine),n)]}})})}function Af(t,e,n){var r=this;void 0===n&&(n={});var i=new Tu;return t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(r,void 0,void 0,function(){var r;return Object(mt.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new pf({next:function(o){e.enqueueAndForget(function(){return bl(t,s)});var a=o.docs.has(n);!a&&o.fromCache?i.reject(new xi(Di.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new xi(Di.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Tl(Zo(n.path),o,{includeMetadataChanges:!0,so:!0});return vl(t,s)},[4,Sf(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}function kf(t,e,n){var r=this;void 0===n&&(n={});var i=new Tu;return t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(r,void 0,void 0,function(){var r;return Object(mt.d)(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new pf({next:function(n){e.enqueueAndForget(function(){return bl(t,s)}),n.fromCache&&"server"===r.source?i.reject(new xi(Di.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Tl(n,o,{includeMetadataChanges:!0,so:!0});return vl(t,s)},[4,Sf(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}})})}),i.promise}var Df=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},xf=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Nf=new Map,jf=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Cf=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(ph.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Pf=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Rf=function(){function t(t){var e=this;this.currentUser=ph.UNAUTHENTICATED,this.oc=new Tu,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable(function(){return e.changeListener(e.currentUser)})};var n=function(t){Ci("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit(function(t){return n(t)}),setTimeout(function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Ci("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}},0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.cc!==e?(Ci("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Mi("string"==typeof n.accessToken),new jf(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return Object(mt.b)(n,void 0,void 0,function(){return Object(mt.d)(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Mi(null===t||"string"==typeof t),new ph(t)},t}(),Lf=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=ph.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Vf=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Lf(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(ph.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Mf(t,e,n){if(!n)throw new xi(Di.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Uf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new xi(Di.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Ff(t,e,n,r){if(!0===e&&!0===r)throw new xi(Di.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function qf(t){if(!fo.isDocumentKey(t))throw new xi(Di.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Bf(t){if(fo.isDocumentKey(t))throw new xi(Di.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Qf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Vi()}function Kf(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new xi(Di.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Qf(t);throw new xi(Di.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Gf(t,e){if(e<=0)throw new xi(Di.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var zf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new xi(Di.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new xi(Di.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Ff("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Hf=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zf({}),this._settingsFrozen=!1,t instanceof xf?(this._databaseId=t,this._credentials=new Cf):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new xi(Di.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xf(t.options.projectId)}(t),this._credentials=new Rf(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new xi(Di.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new xi(Di.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zf(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Cf;switch(t.type){case"gapi":var e=t.client;return Mi(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Vf(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new xi(Di.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=Nf.get(this))&&(Ci("ComponentProvider","Removing Datastore"),Nf.delete(this),t.terminate()),Promise.resolve();var t},t}(),Wf=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Xf(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),$f=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Xf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Zo(r))||this)._path=r,i.type="collection",i}return Object(mt.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Wf(this.firestore,null,new fo(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}($f);function Yf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(vt.h)(t),Mf("collection","path",e),t instanceof Hf)return Bf(n=Yi.fromString.apply(Yi,Object(mt.f)([e],r))),new Xf(t,null,n);if(!(t instanceof Wf||t instanceof Xf))throw new xi(Di.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Bf(n=Yi.fromString.apply(Yi,Object(mt.f)([t.path],r)).child(Yi.fromString(e))),new Xf(t.firestore,null,n)}function Jf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Object(vt.h)(t),1===arguments.length&&(e=qi.u()),Mf("doc","path",e),t instanceof Hf)return qf(n=Yi.fromString.apply(Yi,Object(mt.f)([e],r))),new Wf(t,null,new fo(n));if(!(t instanceof Wf||t instanceof Xf))throw new xi(Di.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return qf(n=t._path.child(Yi.fromString.apply(Yi,Object(mt.f)([e],r)))),new Wf(t.firestore,t instanceof Xf?t.converter:null,new fo(n))}function Zf(t,e){return t=Object(vt.h)(t),e=Object(vt.h)(e),(t instanceof Wf||t instanceof Xf)&&(e instanceof Wf||e instanceof Xf)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function td(t,e){return t=Object(vt.h)(t),e=Object(vt.h)(e),t instanceof $f&&e instanceof $f&&t.firestore===e.firestore&&us(t._query,e._query)&&t.converter===e.converter}var ed=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new Ch(this,"async_queue_retry"),this.Tc=function(){var e=Nh();e&&Ci("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Nh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=Nh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise(function(t){}):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.Rc()})},t.prototype.Rc=function(){return Object(mt.b)(this,void 0,void 0,function(){var t,e=this;return Object(mt.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Du(t=n.sent()))throw t;return Ci("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return e.Rc()}),n.label=5;case 5:return[2]}})})},t.prototype.Ac=function(t){var e=this,n=this.dc.then(function(){return e.gc=!0,t().catch(function(t){throw e.yc=t,e.gc=!1,Pi("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.gc=!1,t})});return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=ll.createAndSchedule(this,t,e,n,function(t){return r.bc(t)});return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&Vi()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return Object(mt.b)(this,void 0,void 0,function(){var t;return Object(mt.d)(this,function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then(function(){e.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()})},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function nd(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this._progressObserver={},this._taskCompletionResolver=new Tu,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}();var rd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new ed,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Object(mt.c)(e,t),e.prototype._terminate=function(){return this._firestoreClient||od(this),this._firestoreClient.terminate()},e}(Hf);function id(t){return t._firestoreClient||od(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function od(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Df(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new mf(t._credentials,t._queue,r)}function sd(t,e,n){var r=this,i=new Tu;return t.asyncQueue.enqueue(function(){return Object(mt.b)(r,void 0,void 0,function(){var r;return Object(mt.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,vf(t,n)];case 1:return o.sent(),[4,bf(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Di.FAILED_PRECONDITION||t.code===Di.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function ad(t){if(t._initialized||t._terminated)throw new xi(Di.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var ud=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new xi(Di.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zi(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),cd=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(eo.fromBase64String(e))}catch(e){throw new xi(Di.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(eo.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),hd=function(t){this._methodName=t},ld=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new xi(Di.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new xi(Di.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Bi(this._lat,t._lat)||Bi(this._long,t._long)},t}(),fd=/^__.*__$/,dd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Fs(t,this.data,this.fieldMask,e,this.fieldTransforms):new Us(t,this.data,e,this.fieldTransforms)},t}(),pd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Fs(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function gd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Vi()}}var yd=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return Ld(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(gd(this.Cc)&&fd.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),md=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||jh(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new yd({Cc:t,methodName:e,Bc:n,path:Zi.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function vd(t){var e=t._freezeSettings(),n=jh(t._databaseId);return new md(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);jd("Data must be an object, but it was:",s,r);var a,u,c=xd(r,s);if(o.merge)a=new to(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=Cd(e,f[l],n);if(!s.contains(d))throw new xi(Di.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Vd(h,d)||h.push(d)}a=new to(h),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new dd(new ko(c),a,u)}var wd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(mt.c)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw t.Mc(1===t.Cc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(hd);function Ed(t,e,n){return new yd({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Id=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(mt.c)(e,t),e.prototype._toFieldTransform=function(t){return new Ds(t.path,new Es)},e.prototype.isEqual=function(t){return t instanceof e},e}(hd),Td=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(mt.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Ed(this,t,!0),n=this.Uc.map(function(t){return Dd(t,e)}),r=new Is(n);return new Ds(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(hd),Od=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return Object(mt.c)(e,t),e.prototype._toFieldTransform=function(t){var e=Ed(this,t,!0),n=this.Uc.map(function(t){return Dd(t,e)}),r=new Os(n);return new Ds(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(hd),_d=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Object(mt.c)(e,t),e.prototype._toFieldTransform=function(t){var e=new Ss(t.R,ys(t.R,this.Kc));return new Ds(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(hd);function Sd(t,e,n,r){var i=t.qc(1,e,n);jd("Data must be an object, but it was:",i,r);var o=[],s=ko.empty();Wi(r,function(t,r){var a=Rd(e,t,n);r=Object(vt.h)(r);var u=i.$c(a);if(r instanceof wd)o.push(a);else{var c=Dd(r,u);null!=c&&(o.push(a),s.set(a,c))}});var a=new to(o);return new pd(s,a,i.fieldTransforms)}function Ad(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[Cd(e,r,n)],u=[i];if(o.length%2!=0)throw new xi(Di.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Cd(e,o[c])),u.push(o[c+1]);for(var h=[],l=ko.empty(),f=a.length-1;f>=0;--f)if(!Vd(h,a[f])){var d=a[f],p=u[f];p=Object(vt.h)(p);var g=s.$c(d);if(p instanceof wd)h.push(d);else{var y=Dd(p,g);null!=y&&(h.push(d),l.set(d,y))}}var m=new to(h);return new pd(l,m,s.fieldTransforms)}function kd(t,e,n,r){return void 0===r&&(r=!1),Dd(n,t.qc(r?4:3,e))}function Dd(t,e){if(Nd(t=Object(vt.h)(t)))return jd("Unsupported field value:",e,t),xd(t,e);if(t instanceof hd)return function(t,e){if(!gd(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Dd(o[i],e.Oc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Object(vt.h)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ys(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Gi.fromDate(t);return{timestampValue:Oa(e.R,n)}}if(t instanceof Gi)return n=new Gi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Oa(e.R,n)};if(t instanceof ld)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof cd)return{bytesValue:_a(e.R,t._byteString)};if(t instanceof Wf){var r=t.firestore._databaseId;if(!r.isEqual(n=e.databaseId))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ka(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+Qf(t))}(t,e)}function xd(t,e){var n={};return $i(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Wi(t,function(t,r){var i=Dd(r,e.xc(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function Nd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Gi||t instanceof ld||t instanceof cd||t instanceof Wf||t instanceof hd)}function jd(t,e,n){if(!Nd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Qf(n);throw e.Mc("an object"===r?t+" a custom object":t+" "+r)}}function Cd(t,e,n){if((e=Object(vt.h)(e))instanceof ud)return e._internalPath;if("string"==typeof e)return Rd(t,e);throw Ld("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Pd=new RegExp("[~\\*/\\[\\]]");function Rd(t,e,n){if(e.search(Pd)>=0)throw Ld("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(ud.bind.apply(ud,Object(mt.f)([void 0],e.split(".")))))._internalPath}catch(Lp){throw Ld("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Ld(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new xi(Di.INVALID_ARGUMENT,(a+=". ")+t+u)}function Vd(t,e){return t.some(function(t){return t.isEqual(e)})}var Md=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Wf(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Ud(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Fd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Ud=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(mt.c)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Md);function Fd(t,e){return"string"==typeof e?Rd(t,e):e instanceof ud?e._internalPath:e._delegate._internalPath}var qd=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Bd=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Object(mt.c)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Qd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Fd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Md),Qd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(mt.c)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Bd),Kd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new qd(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach(function(r){t.call(e,new Qd(n._firestore,n._userDataWriter,r.key,r,new qd(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new xi(Di.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map(function(e){return{type:"added",doc:new Qd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new qd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}})}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new Qd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new qd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Gd(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Gd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vi()}}function zd(t,e){return t instanceof Bd&&e instanceof Bd?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Kd&&e instanceof Kd&&t._firestore===e._firestore&&td(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Hd(t){if(es(t)&&0===t.explicitOrderBy.length)throw new xi(Di.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Wd=function(){};function $d(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Xd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qc=e,i.jc=n,i.Wc=r,i.type="where",i}return Object(mt.c)(e,t),e.prototype._apply=function(t){var e=vd(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new xi(Di.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){rp(s,o);for(var u=[],c=0,h=s;c<h.length;c++)u.push(np(r,t,h[c]));a={arrayValue:{values:u}}}else a=np(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||rp(s,o),a=kd(n,"where",s,"in"===o||"not-in"===o);var l=Lo.create(i,o,a);return function(t,e){if(e.g()){var n=rs(t);if(null!==n&&!n.isEqual(e.field))throw new xi(Di.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=ns(t);null!==r&&ip(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw new xi(Di.INVALID_ARGUMENT,i===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t._query,0,e,t.firestore._databaseId,this.Qc,this.jc,this.Wc);return new $f(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Wd),Yd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qc=e,r.Gc=n,r.type="orderBy",r}return Object(mt.c)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new xi(Di.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new xi(Di.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ho(e,n);return function(t,e){if(null===ns(t)){var n=rs(t);null!==n&&ip(0,n,e.field)}}(t,r),r}(t._query,this.Qc,this.Gc);return new $f(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Yo(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Wd),Jd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return Object(mt.c)(e,t),e.prototype._apply=function(t){return new $f(t.firestore,t.converter,as(t._query,this.zc,this.Hc))},e}(Wd),Zd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(mt.c)(e,t),e.prototype._apply=function(t){var e=ep(t,this.type,this.Jc,this.Yc);return new $f(t.firestore,t.converter,function(t,e){return new Yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Wd),tp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return Object(mt.c)(e,t),e.prototype._apply=function(t){var e=ep(t,this.type,this.Jc,this.Yc);return new $f(t.firestore,t.converter,function(t,e){return new Yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Wd);function ep(t,e,n,r){if(n[0]=Object(vt.h)(n[0]),n[0]instanceof Md)return function(t,e,n,r,i){if(!r)throw new xi(Di.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=os(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Eo(e,r.key));else{var c=r.data.field(u.field);if(so(c))throw new xi(Di.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new xi(Di.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Go(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=vd(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new xi(Di.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new xi(Di.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!is(t)&&-1!==c.indexOf("/"))throw new xi(Di.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Yi.fromString(c));if(!fo.isDocumentKey(h))throw new xi(Di.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new fo(h);a.push(Eo(e,l))}else{var f=kd(n,r,c);a.push(f)}}return new Go(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function np(t,e,n){if("string"==typeof(n=Object(vt.h)(n))){if(""===n)throw new xi(Di.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!is(e)&&-1!==n.indexOf("/"))throw new xi(Di.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Yi.fromString(n));if(!fo.isDocumentKey(r))throw new xi(Di.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Eo(t,new fo(r))}if(n instanceof Wf)return Eo(t,n._key);throw new xi(Di.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Qf(n)+".")}function rp(t,e){if(!Array.isArray(t)||0===t.length)throw new xi(Di.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new xi(Di.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function ip(t,e,n){if(!n.isEqual(e))throw new xi(Di.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var op=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),po(t)){case 0:return null;case 1:return t.booleanValue;case 2:return io(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(oo(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Vi()}},t.prototype.convertObject=function(t,e){var n=this,r={};return Wi(t.fields,function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertGeoPoint=function(t){return new ld(io(t.latitude),io(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=ao(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(uo(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=ro(t);return new Gi(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=Yi.fromString(t);Mi(Za(n));var r=new xf(n.get(1),n.get(3)),i=new fo(n.popFirst(5));return r.isEqual(e)||Pi("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function sp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ap=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(mt.c)(e,t),e.prototype.convertBytes=function(t){return new cd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Wf(this.firestore,null,e)},e}(op),up=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=vd(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=cp(t,this._firestore),i=sp(r.converter,e,n),o=bd(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Ns.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=cp(t,this._firestore);return o="string"==typeof(e=Object(vt.h)(e))||e instanceof ud?Ad(this._dataReader,"WriteBatch.update",s._key,e,n,r):Sd(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Ns.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=cp(t,this._firestore);return this._mutations=this._mutations.concat(new zs(e._key,Ns.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new xi(Di.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function cp(t,e){if((t=Object(vt.h)(t)).firestore!==e)throw new xi(Di.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var hp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(mt.c)(e,t),e.prototype.convertBytes=function(t){return new cd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Wf(this.firestore,null,e)},e}(op);function lp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Kf(t,Wf);var o=Kf(t.firestore,rd),s=vd(o);return dp(o,[("string"==typeof(e=Object(vt.h)(e))||e instanceof ud?Ad(s,"updateDoc",t._key,e,n,r):Sd(s,"updateDoc",t._key,e)).toMutation(t._key,Ns.exists(!0))])}function fp(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Object(vt.h)(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||nd(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(nd(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof Wf)c=Kf(t.firestore,rd),h=Zo(t._key.path),u={next:function(e){i[a]&&i[a](pp(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=Kf(t,$f);c=Kf(d.firestore,rd),h=d._query;var p=new hp(c);u={next:function(t){i[a]&&i[a](new Kd(c,p,d,t))},error:i[a+1],complete:i[a+2]},Hd(t._query)}return function(t,e,n,r){var i=this,o=new pf(r),s=new Tl(e,o,n);return t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(i,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){switch(n.label){case 0:return e=vl,[4,Sf(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){o.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(i,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){switch(n.label){case 0:return e=bl,[4,Sf(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(id(c),h,l,u)}function dp(t,e){return function(t,e){var n=this,r=new Tu;return t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(n,void 0,void 0,function(){var n;return Object(mt.d)(this,function(i){switch(i.label){case 0:return n=Rl,[4,_f(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(id(t),e)}function pp(t,e,n){var r=n.docs.get(e._key),i=new hp(t);return new Bd(t,i,e._key,r,new qd(n.hasPendingWrites,n.fromCache),e.converter)}var gp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Object(mt.c)(e,t),e.prototype.get=function(e){var n=this,r=cp(e,this._firestore),i=new hp(this._firestore);return t.prototype.get.call(this,e).then(function(t){return new Bd(n._firestore,i,r._key,t._document,new qd(!1,!1),r.converter)})},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=vd(t)}return t.prototype.get=function(t){var e=this,n=cp(t,this._firestore),r=new ap(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return Vi();var i=t[0];if(i.isFoundDocument())return new Md(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Md(e._firestore,r,n._key,null,n.converter);throw Vi()})},t.prototype.set=function(t,e,n){var r=cp(t,this._firestore),i=sp(r.converter,e,n),o=bd(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=cp(t,this._firestore);return o="string"==typeof(e=Object(vt.h)(e))||e instanceof ud?Ad(this._dataReader,"Transaction.update",s._key,e,n,r):Sd(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=cp(t,this._firestore);return this._transaction.delete(e._key),this},t}());function yp(){if("undefined"==typeof Uint8Array)throw new xi(Di.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function mp(){if("undefined"==typeof atob)throw new xi(Di.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var vp=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return mp(),new t(cd.fromBase64String(e))},t.fromUint8Array=function(e){return yp(),new t(cd.fromUint8Array(e))},t.prototype.toBase64=function(){return mp(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return yp(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),bp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){ad(t=Kf(t,rd));var n=id(t),r=t._freezeSettings(),i=new df;return sd(n,i,new lf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){ad(t=Kf(t,rd));var e=id(t),n=t._freezeSettings(),r=new df;return sd(e,r,new ff(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new xi(Di.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Tu;return t._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(mt.b)(e,void 0,void 0,function(){var e;return Object(mt.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Object(mt.b)(this,void 0,void 0,function(){return Object(mt.d)(this,function(e){switch(e.label){case 0:return Su.yt()?[4,Su.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}})})}(Vc(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._delegate)},t}(),wp=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof xf||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Ri("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=Kf(t,Hf))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Ri("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=Object(vt.d)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new xi(Di.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Pf(new jf(o,new ph(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(mt.b)(e,void 0,void 0,function(){var e,n;return Object(mt.d)(this,function(r){switch(r.label){case 0:return[4,If(t)];case 1:return e=r.sent(),[4,Of(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Ui(t);return e.Or.delete(0),Fh(e)}(n))]}})})})}(id(Kf(this._delegate,rd)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue(function(){return Object(mt.b)(e,void 0,void 0,function(){var e,n;return Object(mt.d)(this,function(r){switch(r.label){case 0:return[4,If(t)];case 1:return e=r.sent(),[4,Of(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Object(mt.b)(this,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){switch(n.label){case 0:return(e=Ui(t)).Or.add(0),[4,qh(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(id(Kf(this._delegate,rd)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Ff("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Tu;return t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(e,void 0,void 0,function(){var e;return Object(mt.d)(this,function(r){switch(r.label){case 0:return e=ql,[4,_f(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(id(Kf(this._delegate,rd)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new pf(e);return t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(n,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Ui(t).Gr.add(e),e.next()},[4,Sf(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(n,void 0,void 0,function(){var e;return Object(mt.d)(this,function(n){switch(n.label){case 0:return e=function(t,e){Ui(t).Gr.delete(e)},[4,Sf(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(id(t=Kf(t,rd)),nd(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new xi(Di.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Pp(this,Yf(this._delegate,t))}catch(t){throw Sp(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new _p(this,Jf(this._delegate,t))}catch(t){throw Sp(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Np(this,function(t,e){if(t=Kf(t,Hf),Mf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new xi(Di.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new $f(t,null,function(t){return new Yo(Yi.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Sp(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Tu;return t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(n,void 0,void 0,function(){var n;return Object(mt.d)(this,function(i){switch(i.label){case 0:return[4,function(t){return Ef(t).then(function(t){return t.datastore})}(t)];case 1:return n=i.sent(),new yf(t.asyncQueue,n,e,r).run(),[2]}})})}),r.promise}(id(t),function(n){return e(new gp(t,n))})}(this._delegate,function(n){return t(new Ip(e,n))})},t.prototype.batch=function(){var t=this;return id(this._delegate),new Tp(new up(this._delegate,function(e){return dp(t._delegate,e)}))},t.prototype.loadBundle=function(t){throw new xi(Di.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new xi(Di.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Ep=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Object(mt.c)(e,t),e.prototype.convertBytes=function(t){return new vp(new cd(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return _p.tu(e,this.firestore,null)},e}(op),Ip=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Ep(t)}return t.prototype.get=function(t){var e=this,n=Rp(t);return this._delegate.get(n).then(function(t){return new Dp(e._firestore,new Bd(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},t.prototype.set=function(t,e,n){var r=Rp(t);return n?(Uf("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Rp(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(mt.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Rp(t);return this._delegate.delete(e),this},t}(),Tp=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Rp(t);return n?(Uf("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Rp(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Object(mt.f)([s,e,n],i)),this},t.prototype.delete=function(t){var e=Rp(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Op=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Qd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new xp(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Ep(e),n),i.set(n,o)),o},t}();Op.nu=new WeakMap;var _p=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Ep(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new xi(Di.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Wf(n._delegate,r,new fo(e)))},t.tu=function(e,n,r){return new t(n,new Wf(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Pp(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Pp(this.firestore,Yf(this._delegate,t))}catch(t){throw Sp(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Object(vt.h)(t))instanceof Wf&&Zf(this._delegate,t)},t.prototype.set=function(t,e){e=Uf("DocumentReference.set",e);try{return function(t,e,n){t=Kf(t,Wf);var r=Kf(t.firestore,rd),i=sp(t.converter,e,n);return dp(r,[bd(vd(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Ns.none())])}(this._delegate,t,e)}catch(t){throw Sp(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?lp(this._delegate,t):lp.apply(void 0,Object(mt.f)([this._delegate,t,e],n))}catch(t){throw Sp(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return dp(Kf((t=this._delegate).firestore,rd),[new zs(t._key,Ns.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ap(e),i=kp(e,function(e){return new Dp(t.firestore,new Bd(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))});return fp(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Kf(t,Wf);var e=Kf(t.firestore,rd),n=id(e),r=new hp(e);return function(t,e){var n=this,r=new Tu;return t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(n,void 0,void 0,function(){var n;return Object(mt.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r,i;return Object(mt.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Ui(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)})}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new xi(Di.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=fl(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,Tf(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._key).then(function(n){return new Bd(e,r,t._key,n,new qd(null!==n&&n.hasLocalMutations,!0),t.converter)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Kf(t,Wf);var e=Kf(t.firestore,rd);return Af(id(e),t._key,{source:"server"}).then(function(n){return pp(e,t,n)})}(this._delegate):function(t){t=Kf(t,Wf);var e=Kf(t.firestore,rd);return Af(id(e),t._key).then(function(n){return pp(e,t,n)})}(this._delegate)).then(function(t){return new Dp(e.firestore,new Bd(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Op.eu(this.firestore,e):null))},t}();function Sp(t,e,n){return t.message=t.message.replace(e,n),t}function Ap(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!nd(r))return r}return{}}function kp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=nd(t[0])?t[0]:nd(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Dp=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new _p(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return zd(this._delegate,t._delegate)},t}(),xp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(mt.c)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Dp),Np=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Ep(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,$d(this._delegate,function(t,e,n){var r=e,i=Fd("where",t);return new Xd(i,r,n)}(e,n,r)))}catch(e){throw Sp(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,$d(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Fd("orderBy",t);return new Yd(r,n)}(e,n)))}catch(e){throw Sp(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,$d(this._delegate,function(t){return Gf("limit",t),new Jd("limit",t,"F")}(e)))}catch(e){throw Sp(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,$d(this._delegate,function(t){return Gf("limitToLast",t),new Jd("limitToLast",t,"L")}(e)))}catch(e){throw Sp(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,$d(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zd("startAt",t,!0)}).apply(void 0,e)))}catch(e){throw Sp(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,$d(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Zd("startAfter",t,!1)}).apply(void 0,e)))}catch(e){throw Sp(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,$d(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new tp("endBefore",t,!0)}).apply(void 0,e)))}catch(e){throw Sp(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,$d(this._delegate,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new tp("endAt",t,!1)}).apply(void 0,e)))}catch(e){throw Sp(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return td(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Kf(t,$f);var e=Kf(t.firestore,rd),n=id(e),r=new hp(e);return function(t,e){var n=this,r=new Tu;return t.asyncQueue.enqueueAndForget(function(){return Object(mt.b)(n,void 0,void 0,function(){var n;return Object(mt.d)(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return Object(mt.b)(this,void 0,void 0,function(){var r,i,o,s,a;return Object(mt.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,Jc(t,e,!0)];case 1:return a=u.sent(),r=new kl(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=fl(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,Tf(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t._query).then(function(n){return new Kd(e,r,t,n)})}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Kf(t,$f);var e=Kf(t.firestore,rd),n=id(e),r=new hp(e);return kf(n,t._query,{source:"server"}).then(function(n){return new Kd(e,r,t,n)})}(this._delegate):function(t){t=Kf(t,$f);var e=Kf(t.firestore,rd),n=id(e),r=new hp(e);return Hd(t._query),kf(n,t._query).then(function(n){return new Kd(e,r,t,n)})}(this._delegate)).then(function(t){return new Cp(e.firestore,new Kd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ap(e),i=kp(e,function(e){return new Cp(t.firestore,new Kd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))});return fp(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?Op.eu(this.firestore,e):null))},t}(),jp=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new xp(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Cp=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Np(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map(function(e){return new xp(t._firestore,e)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new jp(e._firestore,t)})},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach(function(r){t.call(e,new xp(n._firestore,r))})},t.prototype.isEqual=function(t){return zd(this._delegate,t._delegate)},t}(),Pp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Object(mt.c)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new _p(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new _p(this.firestore,void 0===t?Jf(this._delegate):Jf(this._delegate,t))}catch(t){throw Sp(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Kf(t.firestore,rd),r=Jf(t),i=sp(t.converter,e);return dp(n,[bd(vd(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Ns.exists(!1))]).then(function(){return r})}(this._delegate,t).then(function(t){return new _p(e.firestore,t)})},e.prototype.isEqual=function(t){return Zf(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?Op.eu(this.firestore,t):null))},e}(Np);function Rp(t){return Kf(t,Wf)}var Lp,Vp=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(ud.bind.apply(ud,Object(mt.f)([void 0],t)))}return t.documentId=function(){return new t(Zi.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Object(vt.h)(t))instanceof ud&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Mp=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Id("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new wd("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Td("arrayUnion",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Od("arrayRemove",t)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new _d("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),Up=n("/6Yf"),Fp={Firestore:wp,GeoPoint:ld,Timestamp:Gi,Blob:vp,Transaction:Ip,WriteBatch:Tp,DocumentReference:_p,DocumentSnapshot:Dp,Query:Np,QueryDocumentSnapshot:xp,QuerySnapshot:Cp,CollectionReference:Pp,FieldPath:Vp,FieldValue:Mp,setLogLevel:function(t){Ni.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Up.a("firestore",function(t){return function(t,e){return new wp(t,new rd(t,e),new bp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Fp)))})(Lp=yt.a),Lp.registerVersion("@firebase/firestore","2.3.8");var qp=n("UbJi");function Bp(t,e){return function(t,e=at.b){return new a.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{null!=r&&r()}})}(t,e)}function Qp(t,e){return Bp(t,e).pipe(Object(f.a)(t=>({payload:t,type:"query"})))}function Kp(t,e){return Qp(t,e).pipe(Object(ct.a)(void 0),Object(ht.a)(),Object(f.a)(([t,e])=>{const n=e.payload.docChanges(),r=n.map(t=>({type:t.type,payload:t}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(e.payload.metadata)&&e.payload.docs.forEach((e,i)=>{const o=n.find(t=>t.doc.ref.isEqual(e.ref)),s=null==t?void 0:t.payload.docs.find(t=>t.ref.isEqual(e.ref));o&&JSON.stringify(o.doc.metadata)===JSON.stringify(e.metadata)||!o&&s&&JSON.stringify(s.metadata)===JSON.stringify(e.metadata)||r.push({type:"modified",payload:{oldIndex:i,newIndex:i,type:"modified",doc:e}})}),r}))}function Gp(t,e,n){return Kp(t,n).pipe(Object(lt.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return zp(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return zp(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return zp(t,e.oldIndex,1)}return t}(t,e))}),t}(t,n.map(t=>t.payload),e),[]),Object(ft.a)(),Object(f.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function zp(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function Hp(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class Wp{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){let e=Kp(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Object(f.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)))),e.pipe(Object(ct.a)(void 0),Object(ht.a)(),Object(l.a)(([t,e])=>e.length>0||!t),Object(f.a)(([t,e])=>e),this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(lt.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Hp(t);return Gp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Qp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(f.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(ut.a)(this.query.get(t)).pipe(Object(dt.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new $p(this.ref.doc(t),this.afs)}}class $p{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=eg(n,e);return new Wp(r,i,this.afs)}snapshotChanges(){return Bp(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(ct.a)(void 0),Object(ht.a)(),Object(f.a)(([t,e])=>e.exists?(null==t?void 0:t.exists)?{payload:e,type:"modified"}:{payload:e,type:"added"}:{payload:e,type:"removed"})).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return this.snapshotChanges().pipe(Object(f.a)(({payload:e})=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return Object(ut.a)(this.ref.get(t)).pipe(Object(dt.b)(this.afs.schedulers.insideAngular))}}class Xp{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?Kp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(f.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(l.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):Kp(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(lt.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=Hp(t);return Gp(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return Qp(this.query,this.afs.schedulers.outsideAngular).pipe(Object(f.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign({[t.idField]:e.id},e.data()):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(ut.a)(this.query.get(t)).pipe(Object(dt.b)(this.afs.schedulers.insideAngular))}}const Yp=new i.s("angularfire2.enableFirestorePersistence"),Jp=new i.s("angularfire2.firestore.persistenceSettings"),Zp=new i.s("angularfire2.firestore.settings"),tg=new i.s("angularfire2.firestore.use-emulator");function eg(t,e=(t=>t)){return{query:e(t),ref:t}}let ng=(()=>{class t{constructor(t,e,n,i,o,s,a,u,c){this.schedulers=new pt.d(s),this.keepUnstableUntilFirst=Object(pt.h)(this.schedulers);const l=Object(pt.g)(t,s,e);!gt.a.auth&&c&&Object(pt.j)();const f=u;[this.firestore,this.persistenceEnabled$]=Object(pt.f)(`${l.name}.firestore`,"AngularFirestore",l,()=>{const t=s.runOutsideAngular(()=>l.firestore());if(i&&t.settings(i),f&&t.useEmulator(...f),n&&!Object(r.v)(o)){const e=()=>{try{return Object(ut.a)(t.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(Lp){return"undefined"!=typeof console&&console.warn(Lp),Object(h.a)(!1)}};return[t,s.runOutsideAngular(e)]}return[t,Object(h.a)(!1)]},[i,f,n])}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=eg(n,e),o=this.schedulers.ngZone.run(()=>r);return new Wp(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new Xp(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new $p(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(i.Zb(pt.c),i.Zb(pt.b,8),i.Zb(Yp,8),i.Zb(Zp,8),i.Zb(i.D),i.Zb(i.B),i.Zb(Jp,8),i.Zb(tg,8),i.Zb(qp.b,8))},t.\u0275prov=i.Lb({factory:function(){return new t(i.Zb(pt.c),i.Zb(pt.b,8),i.Zb(Yp,8),i.Zb(Zp,8),i.Zb(i.D),i.Zb(i.B),i.Zb(Jp,8),i.Zb(tg,8),i.Zb(qp.b,8))},token:t,providedIn:"any"}),t})();var rg=n("kmnG"),ig=n("qFsG"),og=n("3Pt+");let sg=(()=>{class t{constructor(t,e,n,r){this.dialogRef=t,this.data=e,this.db=n,this.auth=r,this.userData={}}ngOnInit(){this.auth.user.subscribe(t=>{this.userData=t})}saveData(){if(this.loading=!0,null==this.data.id){let t=(new Date).getTime().toString();this.data.uid=this.userData.uid,this.db.collection("books").doc(t).set(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1,alert("Cerita Berhasil Disimpan")}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak Dapat Menyimpan Data. Coba Lagi !")})}else(new Date).getTime().toString(),this.data.uid=this.userData.uid,this.db.collection("books").doc(this.data.id).update(this.data).then(t=>{this.dialogRef.close(this.data),this.loading=!1}).catch(t=>{console.log(t),this.loading=!1,alert("Tidak dapat memperbarui data")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(st.g),i.Pb(st.a),i.Pb(ng),i.Pb(qp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-tambah"]],decls:28,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],["matInput","","maxlenght","10",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"h3",0),i.Ac(1," Detail "),i.Ub(),i.Vb(2,"div",1),i.Vb(3,"mat-form-field",2),i.Vb(4,"mat-label"),i.Ac(5,"Judul"),i.Ub(),i.Vb(6,"input",3),i.dc("ngModelChange",function(t){return e.data.title=t}),i.Ub(),i.Ub(),i.Vb(7,"mat-form-field",2),i.Vb(8,"mat-label"),i.Ac(9,"Penulis"),i.Ub(),i.Vb(10,"input",3),i.dc("ngModelChange",function(t){return e.data.author=t}),i.Ub(),i.Ub(),i.Vb(11,"mat-form-field",2),i.Vb(12,"mat-label"),i.Ac(13,"Cerita Paragraf 1"),i.Ub(),i.Vb(14,"textarea",4),i.dc("ngModelChange",function(t){return e.data.diary=t}),i.Ub(),i.Ub(),i.Vb(15,"mat-form-field",2),i.Vb(16,"mat-label"),i.Ac(17,"Cerita Paragraf 2"),i.Ub(),i.Vb(18,"textarea",3),i.dc("ngModelChange",function(t){return e.data.diary2=t}),i.Ub(),i.Ub(),i.Vb(19,"mat-form-field",2),i.Vb(20,"mat-label"),i.Ac(21,"Cerita Paragraf 3"),i.Ub(),i.Vb(22,"textarea",3),i.dc("ngModelChange",function(t){return e.data.diary3=t}),i.Ub(),i.Ub(),i.Ub(),i.Vb(23,"div",5),i.Vb(24,"button",6),i.Ac(25,"Batal"),i.Ub(),i.Vb(26,"button",7),i.dc("click",function(){return e.saveData()}),i.Ac(27),i.Ub(),i.Ub()),2&t&&(i.Eb(6),i.mc("ngModel",e.data.title),i.Eb(4),i.mc("ngModel",e.data.author),i.Eb(4),i.mc("ngModel",e.data.diary),i.Eb(4),i.mc("ngModel",e.data.diary2),i.Eb(4),i.mc("ngModel",e.data.diary3),i.Eb(4),i.mc("disabled",e.loading),i.Eb(1),i.Bc(e.loading?"Menyimpan...":"Simpan"))},directives:[st.h,st.e,rg.b,rg.e,ig.b,og.c,og.i,og.k,st.c,$.a,st.d],styles:["textarea[_ngcontent-%COMP%]{height:200px}"]}),t})();var ag=n("Wp6s");function ug(t,e){if(1&t&&(i.Vb(0,"div",10),i.Vb(1,"h3",7),i.Ac(2),i.Ub(),i.Vb(3,"h4",7),i.Ac(4),i.ic(5,"date"),i.Ub(),i.Vb(6,"p",7),i.Ac(7),i.Ub(),i.Vb(8,"p",7),i.Ac(9),i.Ub(),i.Vb(10,"p",7),i.Ac(11),i.Ub(),i.Ub()),2&t){const t=i.hc().$implicit,e=i.hc();i.Eb(2),i.Cc("Penulis : ",t.author,""),i.Eb(2),i.Cc("Tanggal Penulisan : ",i.jc(5,5,e.myDate),""),i.Eb(3),i.Bc(t.diary),i.Eb(2),i.Bc(t.diary2),i.Eb(2),i.Bc(t.diary3)}}function cg(t,e){if(1&t){const t=i.Wb();i.Vb(0,"div",11),i.Vb(1,"button",12),i.dc("click",function(){i.tc(t);const e=i.hc(),n=e.$implicit,r=e.index;return i.hc().Tambah(n,r)}),i.Ac(2,"Edit"),i.Ub(),i.Vb(3,"button",13),i.dc("click",function(){i.tc(t);const e=i.hc(),n=e.$implicit,r=e.index;return i.hc().deleteProduct(n.id,r)}),i.Ac(4),i.Ub(),i.Ub()}if(2&t){const t=i.hc().index,e=i.hc();i.Eb(3),i.mc("disabled",e.loadingDelete[t]),i.Eb(1),i.Bc(e.loadingDelete[t]?"Menghapus...":"Delete")}}function hg(t,e){if(1&t){const t=i.Wb();i.Vb(0,"div",4),i.Vb(1,"mat-card",5),i.Vb(2,"div",6),i.dc("click",function(){i.tc(t);const e=i.hc();return e.isHidden=!e.isHidden}),i.Vb(3,"h2",7),i.Ac(4),i.Ub(),i.Ub(),i.Vb(5,"mat-card-content"),i.zc(6,ug,12,7,"div",8),i.zc(7,cg,5,2,"div",9),i.Ub(),i.Ub(),i.Ub()}if(2&t){const t=e.$implicit,n=e.index,r=i.hc();i.Eb(4),i.Dc("",n+1,"\u2003",t.title,""),i.Eb(2),i.mc("ngIf",r.isHidden),i.Eb(1),i.mc("ngIf",r.isHidden)}}let lg=(()=>{class t{constructor(t,e,n){this.dialog=t,this.db=e,this.auth=n,this.myDate=Date.now(),this.userData={},this.isHidden=!1,this.book={},this.books=[],this.loadingDelete={}}ngOnInit(){this.title="Serendipity",this.auth.user.subscribe(t=>{this.userData=t,this.getBooks()})}getBooks(){this.loading=!0,this.db.collection("books",t=>t.where("uid","==",this.userData.uid)).valueChanges({idField:"id"}).subscribe(t=>{console.log(t),this.books=t,this.loading=!1},t=>{this.loading=!1})}Tambah(t,e){this.dialog.open(sg,{width:"600px",height:"570px",data:t}).afterClosed().subscribe(t=>{t&&(-1==e?this.books.push(t):this.books[e]=t)})}deleteProduct(t,e){confirm("Delete item?")&&this.db.collection("books").doc(t).delete().then(t=>{this.books.splice(e,1),this.loadingDelete[e]=!1}).catch(t=>{this.loadingDelete[e]=!1,alert("Tidak Dapat Menghapus Data. Coba Lagi !")})}}return t.\u0275fac=function(e){return new(e||t)(i.Pb(st.b),i.Pb(ng),i.Pb(qp.a))},t.\u0275cmp=i.Jb({type:t,selectors:[["app-serendipity"]],decls:8,vars:2,consts:[[1,"uk-padding","uk-flex"],[1,"uk-width-expand","uk-align-right"],["mat-flat-button","","color","primary",3,"click"],["class","enter1",4,"ngFor","ngForOf"],[1,"enter1"],[1,"warna"],[1,"uk-padding-small","pointerCursor",3,"click"],[1,"w2"],["class","uk-padding-small",4,"ngIf"],["align","right",4,"ngIf"],[1,"uk-padding-small"],["align","right"],["mat-button","",1,"w3",3,"click"],["mat-button","",1,"w4",3,"disabled","click"]],template:function(t,e){1&t&&(i.Vb(0,"div",0),i.Vb(1,"h1"),i.Ac(2),i.Ub(),i.Qb(3,"span",1),i.Vb(4,"button",2),i.dc("click",function(){return e.Tambah({},-1)}),i.Ac(5,"Tambah Cerita"),i.Ub(),i.Ub(),i.zc(6,hg,8,4,"div",3),i.Qb(7,"router-outlet")),2&t&&(i.Eb(2),i.Bc(e.title),i.Eb(4),i.mc("ngForOf",e.books))},directives:[$.a,r.k,H.d,ag.a,ag.b,r.l],pipes:[r.e],styles:[".pointerCursor[_ngcontent-%COMP%]{cursor:pointer}.warna[_ngcontent-%COMP%]{background-color:#1562c7}.enter1[_ngcontent-%COMP%]{padding:10px;margin-left:20px;margin-right:20px}.enter2[_ngcontent-%COMP%]{margin:10px}.w1[_ngcontent-%COMP%]{white-space:pre-wrap;word-wrap:break-word}.w2[_ngcontent-%COMP%]{color:#fff}.w3[_ngcontent-%COMP%]{color:gold}.w4[_ngcontent-%COMP%]{color:red}"]}),t})();var fg=n("xHqg");function dg(t,e){1&t&&i.Ac(0,"Langkah 1")}function pg(t,e){1&t&&i.Ac(0,"Langkah 2")}function gg(t,e){1&t&&i.Ac(0,"Step 3")}const yg=[{path:"",component:rt,children:[{path:"home",component:ot},{path:"serendipity",component:lg},{path:"step",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["app-step"]],decls:30,vars:0,consts:[[1,"uk-padding"],["matStepLabel",""],["src","assets/Step 1.PNG","width","325","height","200"],[1,"uk-width-expand"],["mat-button","","matStepperNext",""],["src","assets/Step 2.PNG","width","325","height","200"],["mat-button","","matStepperPrevious",""],["src","assets/Step 3.PNG","width","325","height","200"]],template:function(t,e){1&t&&(i.Vb(0,"div",0),i.Vb(1,"h1"),i.Ac(2,"Tata Cara Menggunakan Web Aplikasi"),i.Ub(),i.Vb(3,"mat-vertical-stepper"),i.Vb(4,"mat-step"),i.zc(5,dg,1,0,"ng-template",1),i.Vb(6,"p"),i.Ac(7,"Pilih Tambah Cerita"),i.Ub(),i.Qb(8,"img",2),i.Qb(9,"div",3),i.Vb(10,"button",4),i.Ac(11,"Next"),i.Ub(),i.Ub(),i.Vb(12,"mat-step"),i.zc(13,pg,1,0,"ng-template",1),i.Vb(14,"p"),i.Ac(15,"Tuliskan judul, nama penulis, dan cerita yang ingin ditulis"),i.Ub(),i.Qb(16,"img",5),i.Qb(17,"div",3),i.Vb(18,"button",4),i.Ac(19,"Next"),i.Ub(),i.Vb(20,"button",6),i.Ac(21,"Back"),i.Ub(),i.Ub(),i.Vb(22,"mat-step"),i.zc(23,gg,1,0,"ng-template",1),i.Vb(24,"p"),i.Ac(25,"tekan tombol simpan untuk menyimpannya"),i.Ub(),i.Qb(26,"img",7),i.Qb(27,"div",3),i.Vb(28,"button",6),i.Ac(29,"Back"),i.Ub(),i.Ub(),i.Ub(),i.Ub())},directives:[fg.f,fg.a,fg.b,$.a,fg.d,fg.e],styles:[""]}),t})()},{path:"about",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Jb({type:t,selectors:[["app-about"]],decls:44,vars:0,consts:[[1,"uk-padding"],["uk-grid","",1,"uk-margin-medium","uk-text-middle","uk-text-left@s"],[1,"uk-visible@s","uk-width-1-6@s","uk-float-right"],[1,"uk-text-meta"],[1,"uk-width-4-5@s"],[1,"uk-panel","uk-margin-medium","uk-text-middle","uk-text-left@s"],[1,"uk-width-1-5@s"],[1,"marg"],[1,"uk-panel","uk-margin-medium","uk-text-middle","uk-text-center"],["src","assets/Aku1.jpeg",1,"rounded-image"]],template:function(t,e){1&t&&(i.Vb(0,"div",0),i.Vb(1,"div",1),i.Vb(2,"div",2),i.Vb(3,"p",3),i.Ac(4,"Serendipity 30-07-2021"),i.Ub(),i.Vb(5,"p",3),i.Ac(6,"Terimakasih"),i.Ub(),i.Ub(),i.Vb(7,"div",4),i.Vb(8,"h1"),i.Ac(9,"Sejarah WEB"),i.Ub(),i.Vb(10,"p"),i.Ac(11,"Web ini dibuat pada tanggal 24 Mei 2021, web ini dibentuk berdasarkan hasil pemikiran dari sang pembuat dimana sang pembuat berfikir ingin dijadikan seperti apa web yang akan dirinya buat , kemudian dia menemukan ide untuk membuat web dengan nama serendepity dimana serendepity berarti sebuah keberuntungan."),i.Ub(),i.Vb(12,"p"),i.Ac(13,"Serendipity diambil dari bahasa inggris yang berarti keberuntungan, dia teringat kata tersebut yang terdapat dalam sebuah buku karya Royston M. Roberts, dimana di dalam buku tersebut berisi tentang penemuan dari para ilmuan yang di temukan secara tidak sengaja. Hal itulah yang mendasari terbentuknya web serendepity."),i.Ub(),i.Ub(),i.Ub(),i.Vb(14,"div",5),i.Qb(15,"div",6),i.Vb(16,"div",4),i.Vb(17,"h1"),i.Ac(18,"Visi WEB"),i.Ub(),i.Vb(19,"p"),i.Ac(20,"Web ini dibuat dengan tujuan untuk :"),i.Ub(),i.Vb(21,"ol",7),i.Vb(22,"li"),i.Ac(23,"Menyelesaikan Tugas Akhir"),i.Ub(),i.Vb(24,"li"),i.Ac(25,"Menambah pengalaman dalam pembuatan web"),i.Ub(),i.Vb(26,"li"),i.Ac(27,"Menambah pengetahuan"),i.Ub(),i.Vb(28,"li"),i.Ac(29,"Memberi orang tempat untuk mengeluarkan pikirannya"),i.Ub(),i.Vb(30,"li"),i.Ac(31,"Sebagai tempat untuk berbagi cerita"),i.Ub(),i.Ub(),i.Ub(),i.Ub(),i.Vb(32,"div",8),i.Qb(33,"div",6),i.Vb(34,"div",4),i.Vb(35,"h1"),i.Ac(36,"Tentang Pembuat"),i.Ub(),i.Qb(37,"img",9),i.Vb(38,"p"),i.Ac(39,"M. Abhysta Huda"),i.Ub(),i.Vb(40,"p"),i.Ac(41,"Pekalongan, 19 September 2001"),i.Ub(),i.Vb(42,"p"),i.Ac(43,"Universitas Ahmad Dahlan."),i.Ub(),i.Ub(),i.Ub(),i.Ub())},styles:[".marg[_ngcontent-%COMP%]{padding-left:15px}.rounded-image[_ngcontent-%COMP%]{width:150px;height:200px}"]}),t})()},{path:"",pathMatch:"full",redirectTo:"/admin/home"}]}];let mg=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Nb({type:t}),t.\u0275inj=i.Mb({imports:[[r.c,H.c.forChild(yg),it.a,og.e]]}),t})()}}]);